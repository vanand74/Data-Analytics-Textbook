
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Pivot Tables in Pandas &#8212; Data Analytics for Accountants</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Unit 4/4-03 Pivot Tables in Pandas';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Regression" href="4-04%20Regression.html" />
    <link rel="prev" title="Descriptive Statistics" href="4-02%20Descriptive%20Statistics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/Book logo.png" class="logo__image only-light" alt="Data Analytics for Accountants - Home"/>
    <script>document.write(`<img src="../_static/Book logo.png" class="logo__image only-dark" alt="Data Analytics for Accountants - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction and Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 1: Introduction to Python and Programming</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-1%20Intro%20to%20Programming.html">Introduction to Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-2%20Control%20Flow.html">Control Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-3%20Variables.html">Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-4%20Data%20Types.html">Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-5%20Operators.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-6%20The%20Print%20Function.html">The Print Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-7%20Collections.html">Collections: Lists, Dictionaries, and Tuples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-8%20Functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-9%20Working%20with%20Strings.html">Working with Strings</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 2: Data Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-01%20Intro%20to%20Visualization.html">Introduction to Visualizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-02%20Intro%20to%20Python%27s%20Bokeh%20library.html">Creating Visualizations with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-03%20Intro%20to%20Tableau.html">Creating Visualizations with Tableau</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-04%20Bar%20charts.html">Bar Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-05%20Histograms.html">Histograms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-06%20Box%20plots.html">Box Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-07%20Scatter%20plots.html">Scatter Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-08%20Line%20charts.html">Line Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-09%20Pie%20charts.html">Pie Charts (yum!)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-10%20Heat%20maps.html">Heat Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-11%20Location-based%20maps.html">Location-based Maps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 3: Working with Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Unit%203/3-01%20Overview%20of%20Working%20with%20Data.html">Overview of Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%203/3-02%20Working%20with%20files%20and%20folders%20on%20your%20computer.html">Working with Files and Folders on Your Computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%203/3-03%20CSV%20files.html">CSV Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%203/3-04%20Overview%20of%20Pandas.html">Overview of Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%203/3-05%20Viewing%20a%20DataFrame.html">Viewing a DataFrame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%203/3-06%20Anatomy%20of%20a%20DataFrame.html">Anatomy of a DataFrame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%203/3-07%20Loading%20Data%20Into%20Pandas.html">Loading Data Into Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%203/3-08%20Selecting%20and%20Filtering%20Data.html">Selecting and Filtering Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%203/3-09%20Creating%20New%20Columns.html">Creating New Columns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%203/3-10%20Sorting%20Data.html">Sorting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%203/3-11%20Modifying%20Data.html">Modifying Data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 4: Analyzing Data</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="4-01%20Overview%20of%20Data%20Anaysis.html">Overview of Analyzing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="4-02%20Descriptive%20Statistics.html">Descriptive Statistics</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Pivot Tables in Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="4-04%20Regression.html">Regression</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/vanand74/Data-Analytics-Textbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/vanand74/Data-Analytics-Textbook/issues/new?title=Issue%20on%20page%20%2FUnit 4/4-03 Pivot Tables in Pandas.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Unit 4/4-03 Pivot Tables in Pandas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Pivot Tables in Pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-pivot-tables-in-pandas">Overview of Pivot Tables in Pandas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-and-loading-the-data">Imports and Loading the Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unique-distinct-values">Unique / Distinct Values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Pivot Tables in Pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-pivot-table">A Simple Pivot Table</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-the-pivot-table-shows-and-how-it-computes-its-values">What the pivot table shows and how it computes its values</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-code-to-generate-the-pivot-table">Understanding the code to generate the pivot table</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-more-than-one-statistic">Computing More Than One Statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-by-multiple-variables-in-rows">Grouping By Multiple Variables in Rows</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-unique-values-when-grouping-by-multiple-variables">Understanding the Unique Values when Grouping By Multiple Variables</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-code-to-create-a-pivot-table-that-groups-by-multiple-variables">Understanding the Code to Create a Pivot Table that Groups By Multiple Variables</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-by-multiple-variables-in-rows-and-columns">Grouping By Multiple Variables in Rows and Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-unique-values-when-grouping-by-multiple-variables-in-rows-and-columns">Understanding the Unique Values When Grouping By Multiple Variables in Rows and Columns</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-code-to-create-a-pivot-table-that-groups-by-multiple-variables-in-rows-and-columns">Understanding the Code to Create a Pivot Table that Groups By Multiple Variables in Rows and Columns</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-statistics-for-multiple-variables">Computing Statistics for Multiple Variables</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-complicated-pivot-tables">More Complicated Pivot Tables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-tips-and-useful-information">Other Tips and Useful Information</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-the-number-of-rows-for-each-unique-value">Counting the Number of Rows for Each Unique Value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pivot-table-function-returns-a-dataframe">The <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> function returns a DataFrame</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pivot-tables-in-pandas">
<h1>Pivot Tables in Pandas<a class="headerlink" href="#pivot-tables-in-pandas" title="Link to this heading">#</a></h1>
<section id="learning-objectives">
<h2>Learning Objectives<a class="headerlink" href="#learning-objectives" title="Link to this heading">#</a></h2>
<div style="border: 1px solid black; padding: 10px; background-color: #EDEDED;">
    <ul>
        <li>Explain the concept of unique values and why it is so important.</li>
        <li>Create a simple pivot table in Pandas that computes one statistic for the unique values of one column.</li>
        <li>Create a pivot table in Pandas that computes multiple statistics for the unique values of one column.</li>
        <li>Create a pivot table in Pandas that groups by multiple variables within rows.</li>
        <li>Create a pivot table in Pandas that groups by two variables organized into rows and columns.</li>
        <li>Create a pivot table in Pandas that computes multiple statistics for the unique values of one column.</li>
        <li>Explain how to create more complicated pivot tables by using the <i>index</i>, <i>columns</i>, <i>values</i>, and <i>aggfunc</i> arguments.</li>
        <li>Use the <i>len</i> function to count the number of rows that exist for unique values in different columns.</li>
        <li>Explain how a Pandas pivot table is a DataFrame, and can be manipulated just like any other DataFrame.</li>
    </ul>
</div></section>
<section id="overview-of-pivot-tables-in-pandas">
<h2>Overview of Pivot Tables in Pandas<a class="headerlink" href="#overview-of-pivot-tables-in-pandas" title="Link to this heading">#</a></h2>
<p>In previous units, we showed you how to <em>prepare</em> your data for analysis. You loaded, cleaned, filtered, and manipulated data. In the previous chapter, we showed you how to begin data analysis by computing descriptive statistics. In this chapter, we will continue our journey into analyzing data by teaching you about pivot tables in Pandas.</p>
<p>A pivot table is a table that provides statistics for unique values of one or more variables. For example, what is the average salary in each department of a company? You will find that pivot tables will be one of the most useful tools in your toolkit. If you are adept at making pivot tables, you will be a star in your job. However, as you learn about pivot tables, realize that the skill lies not in writing code, but in thinking about what you want to learn from your data and interpreting the results. If you can envision the pivot table needed for your business question before you write any code, then the act of creating the table will seem simple.</p>
</section>
<section id="imports-and-loading-the-data">
<h2>Imports and Loading the Data<a class="headerlink" href="#imports-and-loading-the-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>In this chapter, we will work with salary data for employees of the City of New York (<a class="reference external" href="https://data.cityofnewyork.us/City-Government/Citywide-Payroll-Data-Fiscal-Year-/k397-673e">link</a>).</p>
<p>The cell below loads salary data for employees of the City of New York. Each row represents one employee in the one fiscal year. For a list of the columns and their meanings, click <a class="reference external" href="https://data.cityofnewyork.us/City-Government/Citywide-Payroll-Data-Fiscal-Year-/k397-673e">here</a>.</p>
<p><b>NOTE: </b>You need either the <i>fastparquet</i> library or the <i>pyarrow</i> libraryto load the data file used in these notes.</p>
<p>You should have installed one of these libraries at the beginning of the semester when you installed Python. If you did not, or if you get errors, don’t panic. <i>If you just want to read these notes, you do not need to run these cells and you do not need to install either library.</i></p>
<p>If you’re wondering what these libraries do, read this paragraph. The data file is quite large, approximately 376 MB as a CSV. That makes it difficult to share. It has too many rows to store in an Excel worksheet, and if we gave you a CSV, it would take many minutes to load, and you would have to clean many of the columns by converting them from text to other data types. To avoid all this, we chose to store the data in <a class="reference external" href="http://parquet.apache.org/">Apache Parquet</a> format. Parquet is a super-cool format that stores the data by column. That allows it to easily compress the data, because you tend to find the same value repeated many times in each column. This compression reduces the file size (the parquet file is just under 50 MB), and greatly speeds up the loading process. We love the Parquet format and frequently use it when working with larger datasets. It is compatible with many big data and cloud technologies. And Pandas provides support for Parquet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfPay</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;data/NYC_Payroll_data.parquet&#39;</span><span class="p">)</span>
<span class="n">dfPay</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fiscal Year</th>
      <th>Payroll Number</th>
      <th>Agency Name</th>
      <th>Last Name</th>
      <th>First Name</th>
      <th>Mid Init</th>
      <th>Agency Start Date</th>
      <th>Work Location Borough</th>
      <th>Title Description</th>
      <th>Leave Status as of June 30</th>
      <th>Base Salary</th>
      <th>Pay Basis</th>
      <th>Regular Hours</th>
      <th>Regular Gross Paid</th>
      <th>OT Hours</th>
      <th>Total OT Paid</th>
      <th>Total Other Pay</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016</td>
      <td>NaN</td>
      <td>DISTRICT ATTORNEY-MANHATTAN</td>
      <td>ABA'AHMID</td>
      <td>RAHASHEEM</td>
      <td>E</td>
      <td>2003-07-14 00:00:00+00:00</td>
      <td>MANHATTAN</td>
      <td>COMMUNITY ASSOCIATE</td>
      <td>ACTIVE</td>
      <td>47678.0</td>
      <td>PER ANNUM</td>
      <td>1830.00</td>
      <td>47166.03</td>
      <td>2.25</td>
      <td>57.28</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016</td>
      <td>NaN</td>
      <td>DISTRICT ATTORNEY-MANHATTAN</td>
      <td>ABENSUR</td>
      <td>MARGARET</td>
      <td></td>
      <td>1995-06-12 00:00:00+00:00</td>
      <td>MANHATTAN</td>
      <td>ADMINISTRATIVE ACCOUNTANT</td>
      <td>ACTIVE</td>
      <td>119959.0</td>
      <td>PER ANNUM</td>
      <td>1831.00</td>
      <td>119042.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016</td>
      <td>NaN</td>
      <td>DISTRICT ATTORNEY-MANHATTAN</td>
      <td>ABOUNAOUM</td>
      <td>ANDREA</td>
      <td>L</td>
      <td>2011-10-11 00:00:00+00:00</td>
      <td>MANHATTAN</td>
      <td>COMMUNITY ASSOCIATE</td>
      <td>ON LEAVE</td>
      <td>39966.0</td>
      <td>PER ANNUM</td>
      <td>1181.68</td>
      <td>27452.62</td>
      <td>1.00</td>
      <td>21.34</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016</td>
      <td>NaN</td>
      <td>DISTRICT ATTORNEY-MANHATTAN</td>
      <td>ABRAHAM</td>
      <td>JONATHAN</td>
      <td>J</td>
      <td>2014-12-01 00:00:00+00:00</td>
      <td>MANHATTAN</td>
      <td>COMPUTER SYSTEMS MANAGER</td>
      <td>ACTIVE</td>
      <td>116000.0</td>
      <td>PER ANNUM</td>
      <td>1831.00</td>
      <td>115104.57</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016</td>
      <td>NaN</td>
      <td>DISTRICT ATTORNEY-MANHATTAN</td>
      <td>ABRAMS</td>
      <td>JOSEPH</td>
      <td></td>
      <td>2015-05-21 00:00:00+00:00</td>
      <td>MANHATTAN</td>
      <td>COLLEGE AIDE</td>
      <td>CEASED</td>
      <td>1.0</td>
      <td>PER HOUR</td>
      <td>0.00</td>
      <td>3500.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfPay</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2748818, 17)
</pre></div>
</div>
</div>
</div>
</section>
<section id="unique-distinct-values">
<h2>Unique / Distinct Values<a class="headerlink" href="#unique-distinct-values" title="Link to this heading">#</a></h2>
<p>Before we can teach you about pivot tables, we need to teach you an important underlying concept, unique values.</p>
<p>Consider the following randomly chosen values from the <em>Agency Name</em> column of our dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfPay</span><span class="p">[[</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Work Location Borough</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1686946</th>
      <td>BRONX</td>
    </tr>
    <tr>
      <th>535165</th>
      <td>MANHATTAN</td>
    </tr>
    <tr>
      <th>3128672</th>
      <td>MANHATTAN</td>
    </tr>
    <tr>
      <th>1632295</th>
      <td>QUEENS</td>
    </tr>
    <tr>
      <th>3092208</th>
      <td>MANHATTAN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice that certain values are repeated. For example, “MANHATTAN” appears 3 times. What if we want to know all values that appear at least once in the column? We don’t want to see repeats. We simply want to know which values appear at least once in the column. Why would we care to know this? First of all, because we might want a list of the boroughs in New York City! Second, when we create a pivot table, we might want to report statistics by borough. That means that each borough should appear only once in our pivot table.</p>
<p>What we are looking for are the <em>unique</em> values in the column (note that the term <em>distinct</em>, which is used in SQL, is synonymous with <em>unique</em>). Pandas makes it very easy to compute the unique values in a column. Simply call the <code class="docutils literal notranslate"><span class="pre">unique</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;MANHATTAN&#39;, &#39;STATEN ISLAND&#39;, &#39;QUEENS&#39;, &#39;BRONX&#39;, &#39;BROOKLYN&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Another way to get unique values in a column is the <code class="docutils literal notranslate"><span class="pre">value_counts</span></code> method. That method returns the unique values as well as a count of each value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Work Location Borough
MANHATTAN        1975186
QUEENS            314960
BROOKLYN          270173
BRONX             150150
STATEN ISLAND      38349
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We prefer the <code class="docutils literal notranslate"><span class="pre">value_counts</span></code> method to the <code class="docutils literal notranslate"><span class="pre">unique</span></code> method for two reasons. First, <code class="docutils literal notranslate"><span class="pre">value_counts</span></code> returns counts in addition to unique values and these are often useful. For example, we just learned that most of the employees in the dataset work in Manhattan. Second, <code class="docutils literal notranslate"><span class="pre">value_counts</span></code> returns a Pandas Series while <code class="docutils literal notranslate"><span class="pre">unique</span></code> returns a NumPy array. Since we are doing most of our work in Pandas, it’s often easier to work directly with Pandas objects.</p>
<p><strong>The concept of unique values is super important.</strong> Not only does it underlie the pivot tables that we are about to create, but it is also used when merging data tables.</p>
<p>Let’s see one more example of uniqueness. Let’s retrieve the unique departments in the NYC government. From this list, which is quite long (there appear to be 160 departments in the NYC government!), we see that education is largest, followed by police.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Agency Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Agency Name
DEPT OF ED PEDAGOGICAL            471072
DEPT OF ED PER SESSION TEACHER    426514
POLICE DEPARTMENT                 307717
DEPT OF ED PARA PROFESSIONALS     176199
BOARD OF ELECTION POLL WORKERS    170968
                                   ...  
BROOKLYN COMMUNITY BOARD #14          15
BRONX COMMUNITY BOARD #12             15
BRONX COMMUNITY BOARD #5              14
BRONX COMMUNITY BOARD #1              11
BRONX COMMUNITY BOARD #3              10
Name: count, Length: 160, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h2>Pivot Tables in Pandas<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>A pivot table computes something for unique values. That’s all there is to it! :)</p>
<section id="a-simple-pivot-table">
<h3>A Simple Pivot Table<a class="headerlink" href="#a-simple-pivot-table" title="Link to this heading">#</a></h3>
<p>Let’s begin with a simple example: let’s compute the average salary paid to workers in each of NYC’s boroughs. We’ll first filter it to include only fiscal year 2018:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s get cute and display the numbers in accounting format. :)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;float_format&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;$</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dfPay</span><span class="p">[</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2018</span><span class="p">],</span>
               <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">,</span>
               <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Base Salary&#39;</span><span class="p">,</span>
               <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Base Salary</th>
    </tr>
    <tr>
      <th>Work Location Borough</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BRONX</th>
      <td>$49,584</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>$52,777</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>$40,780</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>$52,138</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>$53,919</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="what-the-pivot-table-shows-and-how-it-computes-its-values">
<h4>What the pivot table shows and how it computes its values<a class="headerlink" href="#what-the-pivot-table-shows-and-how-it-computes-its-values" title="Link to this heading">#</a></h4>
<p>Before we examine the code, let’s look at the pivot table. There’s one row per borough. The pivot table computed the unique values in the <em>Work Location Borough</em> column and created one row per unique borough in the resulting pivot table. Then, for each borough, it filtered the data for that borough and computed the average of the base salary for that borough. To see this, consider the following code that produces the exact same values as our pivot table above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get only the 2018 rows. Drop any rows with missing values</span>
<span class="n">df2018</span> <span class="o">=</span> <span class="n">dfPay</span><span class="p">[</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2018</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Base Salary&#39;</span><span class="p">])</span>
<span class="c1"># Now get the unique boroughs as a list</span>
<span class="n">boroughs</span> <span class="o">=</span> <span class="n">df2018</span><span class="p">[</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="c1"># Sort the list of boroughs</span>
<span class="n">boroughs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="c1"># For each borough in the list of unique boroughs</span>
<span class="k">for</span> <span class="n">borough</span> <span class="ow">in</span> <span class="n">boroughs</span><span class="p">:</span>
    <span class="c1"># Filter the 2018 data on that borough</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df2018</span><span class="p">[</span><span class="n">df2018</span><span class="p">[</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">borough</span><span class="p">]</span>
    <span class="c1"># Compute the mean salary for that borough in 2018</span>
    <span class="n">meanSalary</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Base Salary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">borough</span><span class="si">}</span><span class="s2">: $</span><span class="si">{</span><span class="n">meanSalary</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BRONX: $49,584
BROOKLYN: $52,777
MANHATTAN: $40,780
QUEENS: $52,138
STATEN ISLAND: $53,919
</pre></div>
</div>
</div>
</div>
<p>To reiterate, the pivot table computed the unique values in the <em>Work Location Borough</em> column. For each unique borough, it filtered the data for that borough and then computed the average of the <em>Base Salary</em> for that borough.</p>
</section>
<section id="understanding-the-code-to-generate-the-pivot-table">
<h4>Understanding the code to generate the pivot table<a class="headerlink" href="#understanding-the-code-to-generate-the-pivot-table" title="Link to this heading">#</a></h4>
<p>Above, we used the following code to create our pivot table:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dfPay</span><span class="p">[</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2018</span><span class="p">],</span>
               <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">,</span>
               <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Base Salary&#39;</span><span class="p">,</span>
               <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s examine the code and understand what each argument does.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pd.pivot_table</span></code>. This is the Pandas function for creating a pivot table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data=dfPay[dfPay['Fiscal</span> <span class="pre">Year']==2018]</span></code>. You must pass a DataFrame to the <code class="docutils literal notranslate"><span class="pre">data</span></code> argument. This argument is required. The <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> function will use this data to create a pivot table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index='Work</span> <span class="pre">Location</span> <span class="pre">Borough'</span></code>. The <code class="docutils literal notranslate"><span class="pre">index</span></code> argument tells the pivot table which values to use as rows in the resulting pivot table. In this case, we told it to take the <em>Work Location Borough</em> column of our source data and extract its unique values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">values='Base</span> <span class="pre">Salary</span></code>. The pivot table will take the values from this column and use them in its computations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aggfunc='mean'</span></code>. “aggfunc” stands for “aggregation function”. By passing the string <code class="docutils literal notranslate"><span class="pre">'mean'</span></code>, we told Pandas to use the Numpy function <em>numpy.mean</em> as our aggregation function. Thus, the pivot table will average the values in the <em>Base Salary</em> column.</p></li>
</ul>
<p>In sum, the code tells Pandas to take the 2018 data, extract the unique boroughs and, for each borough, compute the mean of the <em>Base Salary</em> column.</p>
</section>
</section>
<section id="computing-more-than-one-statistic">
<h3>Computing More Than One Statistic<a class="headerlink" href="#computing-more-than-one-statistic" title="Link to this heading">#</a></h3>
<p>In the above example, we compute the mean salary paid to workers in each borough in 2018. We will extend that example and show how to compute the mean <em>and</em> median salary for each borough. Look at the following code and its output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dfPay</span><span class="p">[</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2018</span><span class="p">],</span>
               <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">,</span>
               <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Base Salary&#39;</span><span class="p">,</span>
               <span class="n">aggfunc</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>mean</th>
      <th>median</th>
    </tr>
    <tr>
      <th></th>
      <th>Base Salary</th>
      <th>Base Salary</th>
    </tr>
    <tr>
      <th>Work Location Borough</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BRONX</th>
      <td>$49,584</td>
      <td>$48,666</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>$52,777</td>
      <td>$50,604</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>$40,780</td>
      <td>$35,977</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>$52,138</td>
      <td>$50,604</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>$53,919</td>
      <td>$55,024</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice that the first data column, <em>mean Base Salary</em>, contains the exact same information as our table above. However, this new table contains a second column that contains the median salaries.</p>
<p>The only change to the code was to the <em>aggfunc</em> argument. We changed that to <code class="docutils literal notranslate"><span class="pre">aggfunc=['mean',</span> <span class="pre">'median']</span></code>. Instead of passing a function, <em>we passed a list of functions</em>. The <em>pivot_table</em> function then created one column per function. It did everything else identically. It first retrieved the unique boroughs (from the <em>index</em> argument), used values from the <em>Base Salary</em> column in its computations. For each borough, it computed the mean and the median.</p>
</section>
<section id="grouping-by-multiple-variables-in-rows">
<h3>Grouping By Multiple Variables in Rows<a class="headerlink" href="#grouping-by-multiple-variables-in-rows" title="Link to this heading">#</a></h3>
<p>Often, your business question implies a logical hierarchy among your variables. For example, say you want to see the average pay in each department, but you want to break it out by borough. Department heads might want to see this information to know if they are paying appropriate amounts for employees in different parts of the city. Another example is to show the pay by borough and break it out by hourly and salaried employees. This might be useful if one group of employees is unionized and the other is not. Or if the hourly and salaried employees belong to different unions, or if they have different contracts.</p>
<p>In this section, let’s use the example of pay by department and by borough. To make this tractable, we will restrict our analysis to (a) salaried employees (b) in the top 5 departments (c) in 2018.</p>
<p>First, let’s filter the data so we only have rows for salaried employees in 2018 for the top 5 departments. We’ll save the filtered data in a data frame called <em>dfTop5Dept2018</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Condition 1: fiscal year == 2018</span>
<span class="c1"># Condition 2: pay basis == &#39;PER ANNUM&#39;</span>
<span class="c1"># Condition 3: get the top 5 departments, as measured by number of employees.</span>
<span class="c1">#     Save the top 5 departments in the variable top5depts</span>
<span class="n">top5depts</span> <span class="o">=</span>  <span class="n">dfPay</span><span class="p">[(</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2018</span><span class="p">)</span> <span class="o">&amp;</span> 
                   <span class="p">(</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Pay Basis&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PER ANNUM&#39;</span><span class="p">)][</span><span class="s1">&#39;Agency Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># Filter the data frame dfPay using the 3 conditions above.</span>
<span class="n">dfTop5Dept2018</span> <span class="o">=</span> <span class="n">dfPay</span><span class="p">[(</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2018</span><span class="p">)</span> <span class="o">&amp;</span> 
                       <span class="p">(</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Pay Basis&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PER ANNUM&#39;</span><span class="p">)</span> <span class="o">&amp;</span> 
                       <span class="p">(</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Agency Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">top5depts</span><span class="p">))]</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s create a pivot table showing, for each of the top 5 departments in 2018, the average pay in each borough.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dfTop5Dept2018</span><span class="p">,</span> 
               <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Agency Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Work Location Borough&#39;</span><span class="p">],</span> 
               <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Base Salary&#39;</span><span class="p">,</span> 
               <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Base Salary</th>
    </tr>
    <tr>
      <th>Agency Name</th>
      <th>Work Location Borough</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DEPT OF ED PARA PROFESSIONALS</th>
      <th>MANHATTAN</th>
      <td>$36,139</td>
    </tr>
    <tr>
      <th>DEPT OF ED PEDAGOGICAL</th>
      <th>MANHATTAN</th>
      <td>$87,796</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">FIRE DEPARTMENT</th>
      <th>BRONX</th>
      <td>$72,784</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>$77,556</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>$76,143</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>$71,143</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>$80,794</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">HRA/DEPT OF SOCIAL SERVICES</th>
      <th>BRONX</th>
      <td>$47,447</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>$54,658</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>$61,390</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>$46,781</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>$49,353</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">POLICE DEPARTMENT</th>
      <th>BRONX</th>
      <td>$71,268</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>$68,800</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>$78,636</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>$68,304</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>$73,843</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Take a look at the above pivot table. Notice that the <em>Agency Name</em> and <em>Work Location Borough</em> columns are organized into a hierarchy. For each unique level of <em>Agency Name</em>, the pivot table shows all unique values of <em>Work Location Borough</em>. Notice that Pandas omitted boroughs with no employees.</p>
<p>From this table, we can see that two of the top departments in the city, Department of Ed Para Professionals and Dept of Ed Pedagogical, have all of their employees in Manhattan. For the other three departments, we can easily compare average salaries across boroughs. However, we cannot conclude from this that employees in some boroughs get paid more <em>for the same job</em> than their counterparts in other boroughs. To examine that, we would need to compare job titles and years of experience.</p>
<section id="understanding-the-unique-values-when-grouping-by-multiple-variables">
<h4>Understanding the Unique Values when Grouping By Multiple Variables<a class="headerlink" href="#understanding-the-unique-values-when-grouping-by-multiple-variables" title="Link to this heading">#</a></h4>
<p>When you group by multiple variables, you need to think of unique values differently. In the pivot table above, the unique values are (DEPT OF ED PARA PROFESSIONALS, MANHATTAN), (DEPT OF ED PEDAGOGICAL, MANHATTAN), (FIRE DEPARTMENT, BRONX), (FIRE DEPARTMENT, BROOKLYN), etc. In other words, take the unique values from <em>Agency Name</em> and the unique values from <em>Work Location Borough</em>; form every possible combination of unique values. The pivot table computes the mean salary for each unique combination.</p>
</section>
<section id="understanding-the-code-to-create-a-pivot-table-that-groups-by-multiple-variables">
<h4>Understanding the Code to Create a Pivot Table that Groups By Multiple Variables<a class="headerlink" href="#understanding-the-code-to-create-a-pivot-table-that-groups-by-multiple-variables" title="Link to this heading">#</a></h4>
<p>The code to create the pivot table above was:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dfTop5Dept2018</span><span class="p">,</span> 
               <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Agency Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Work Location Borough&#39;</span><span class="p">],</span> 
               <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Base Salary&#39;</span><span class="p">,</span> 
               <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you compare this code to the code from our simplest example, you will discover only one difference. For the <em>index</em> argument, we passed a list of column names. That tells Pandas to group the data first by <em>Agency Name</em> and then by <em>Work Location Borough</em>.</p>
</section>
</section>
<section id="grouping-by-multiple-variables-in-rows-and-columns">
<h3>Grouping By Multiple Variables in Rows and Columns<a class="headerlink" href="#grouping-by-multiple-variables-in-rows-and-columns" title="Link to this heading">#</a></h3>
<p>Often, you want to compute something for two variables but there is no logical hierarchy among the variables. For example, say you want to show the average pay by borough and by fiscal year. We could use a format like that in the previous section, but should we group first by borough and then fiscal year? Or by fiscal year and then borough? There’s no obvious answer. Also, the format shown above does not facilitate comparisons across the second variable. When you find yourself in a situation like this, consider organizing the data into rows and columns.</p>
<p>Take a look at the pivot table below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dfPay</span><span class="p">,</span> 
               <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">,</span> 
               <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">,</span> 
               <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Base Salary&#39;</span><span class="p">,</span> 
               <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> 
               <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Fiscal Year</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Work Location Borough</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BRONX</th>
      <td>$58,788</td>
      <td>$44,626</td>
      <td>$46,477</td>
      <td>$44,402</td>
      <td>$49,584</td>
      <td>$51,025</td>
      <td>$47,251</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>NaN</td>
      <td>$48,105</td>
      <td>$50,254</td>
      <td>$49,710</td>
      <td>$52,777</td>
      <td>$53,834</td>
      <td>$50,901</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>$62,937</td>
      <td>$32,795</td>
      <td>$37,827</td>
      <td>$38,471</td>
      <td>$40,780</td>
      <td>$39,591</td>
      <td>$37,889</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>$71,759</td>
      <td>$47,722</td>
      <td>$50,650</td>
      <td>$48,483</td>
      <td>$52,138</td>
      <td>$52,358</td>
      <td>$50,339</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>$69,804</td>
      <td>$49,004</td>
      <td>$51,869</td>
      <td>$53,531</td>
      <td>$53,919</td>
      <td>$54,322</td>
      <td>$52,599</td>
    </tr>
    <tr>
      <th>All</th>
      <td>$63,752</td>
      <td>$36,720</td>
      <td>$41,248</td>
      <td>$41,382</td>
      <td>$43,979</td>
      <td>$43,116</td>
      <td>$41,311</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The above table lays out the data by borough (rows) and fiscal year (columns). Notice that we included an average for each row (the <em>All</em> column), and an average for each column (the <em>All</em> row). This format allows for easy comparison across boroughs, across fiscal years, and within boroughs. It is a very efficient way to present data.</p>
<section id="understanding-the-unique-values-when-grouping-by-multiple-variables-in-rows-and-columns">
<h4>Understanding the Unique Values When Grouping By Multiple Variables in Rows and Columns<a class="headerlink" href="#understanding-the-unique-values-when-grouping-by-multiple-variables-in-rows-and-columns" title="Link to this heading">#</a></h4>
<p>The unique values for the pivot table are all combinations of unique values of the rows and columns. Thus, (BRONX, 2014) is a unique value, as is (STATEN ISLAND, 2019). The pivot table will compute the mean of the base salary for each of these unique values.</p>
</section>
<section id="understanding-the-code-to-create-a-pivot-table-that-groups-by-multiple-variables-in-rows-and-columns">
<h4>Understanding the Code to Create a Pivot Table that Groups By Multiple Variables in Rows and Columns<a class="headerlink" href="#understanding-the-code-to-create-a-pivot-table-that-groups-by-multiple-variables-in-rows-and-columns" title="Link to this heading">#</a></h4>
<p>Let’s examine the code used to create the pivot table:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dfPay</span><span class="p">,</span> 
               <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">,</span> 
               <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">,</span> 
               <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Base Salary&#39;</span><span class="p">,</span> 
               <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> 
               <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>When you compare this to the simplest pivot table above, you will discover two differences:</p>
<ol class="arabic simple">
<li><p>We added a <em>columns</em> argument. This tells Pandas to get the unique values from the <em>Fiscal Year</em> column and use them as column headings in the pivot table.</p></li>
<li><p>We added the argument <code class="docutils literal notranslate"><span class="pre">margins=True</span></code>. That tells Pandas to include summary rows and columns in the pivot table (the ones with the heading <em>All</em>).</p></li>
</ol>
</section>
</section>
<section id="computing-statistics-for-multiple-variables">
<h3>Computing Statistics for Multiple Variables<a class="headerlink" href="#computing-statistics-for-multiple-variables" title="Link to this heading">#</a></h3>
<p>Another use case for pivot tables is to compute the same statistics for multiple variables. As a simple example, let’s compute the mean salary and mean years of experience by borough.</p>
<p>First, we need to compute the years of experience. Let’s use New York’s 2018 fiscal year, which ran from July 1, 2017 through June 30, 2018. We will compute the number of years of experience at the end of the fiscal year. That way, people who start in the middle of the fiscal year will show up as having a positive amount of work experience. We will also focus on salaried employees only.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter on fiscal year 2018, salaried employees only</span>
<span class="n">dfFilt</span> <span class="o">=</span> <span class="n">dfPay</span><span class="p">[(</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2018</span><span class="p">)</span> <span class="o">&amp;</span> 
               <span class="p">(</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Pay Basis&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PER ANNUM&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># Create a date constant containing the end of the fiscal year</span>
<span class="n">endOfFY</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;6-30-2018&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1">-%Y&#39;</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">dfFilt</span><span class="p">[</span><span class="s1">&#39;Years of Experience&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">endOfFY</span> <span class="o">-</span> <span class="n">dfFilt</span><span class="p">[</span><span class="s1">&#39;Agency Start Date&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">))</span> <span class="o">/</span> <span class="mf">365.0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reset the Pandas display options</span>
<span class="n">pd</span><span class="o">.</span><span class="n">reset_option</span><span class="p">(</span><span class="s1">&#39;float_format&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dfFilt</span><span class="p">,</span>
               <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">,</span>
               <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Base Salary&#39;</span><span class="p">,</span> <span class="s1">&#39;Years of Experience&#39;</span><span class="p">],</span>
               <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Base Salary</th>
      <th>Years of Experience</th>
    </tr>
    <tr>
      <th>Work Location Borough</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BRONX</th>
      <td>65145.129919</td>
      <td>11.126592</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>67400.887592</td>
      <td>11.648366</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>75038.574755</td>
      <td>12.030538</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>68833.177272</td>
      <td>10.573341</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>70285.517079</td>
      <td>12.282185</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In the above code, we passed a list of column names to the <em>Values</em> argument. That told Pandas to compute the mean of each <em>Values</em> column for each unique value in <em>Work Location Borough</em>.</p>
</section>
</section>
<section id="more-complicated-pivot-tables">
<h2>More Complicated Pivot Tables<a class="headerlink" href="#more-complicated-pivot-tables" title="Link to this heading">#</a></h2>
<p>In this chapter, we showed you how to create simple pivot tables in Pandas. You can create much more complicated tables by passing lists to multiple arguments in the <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> function. For example, say we want to recreate a pivot table that breaks out Pay Basis by Borough (rows). In each column, we want to show a different fiscal year. And we want to do this for two variables, <em>Base Salary</em> and <em>Total Other Pay</em>. You could do that as follows. Notice that all we’re doing is passing more columns to the arguments than we did previously.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dfPay</span><span class="p">,</span>
               <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">,</span> <span class="s1">&#39;Pay Basis&#39;</span><span class="p">],</span>
               <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">,</span>
               <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Base Salary&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Other Pay&#39;</span><span class="p">],</span>
               <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="6" halign="left">Base Salary</th>
      <th colspan="6" halign="left">Total Other Pay</th>
    </tr>
    <tr>
      <th></th>
      <th>Fiscal Year</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
    </tr>
    <tr>
      <th>Work Location Borough</th>
      <th>Pay Basis</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">BRONX</th>
      <th>PER ANNUM</th>
      <td>58914.094319</td>
      <td>60474.766639</td>
      <td>62271.607774</td>
      <td>64138.005775</td>
      <td>65145.129919</td>
      <td>65869.988143</td>
      <td>691.695520</td>
      <td>6114.452525</td>
      <td>6088.658542</td>
      <td>6196.082143</td>
      <td>6418.858816</td>
      <td>6075.399860</td>
    </tr>
    <tr>
      <th>PER DAY</th>
      <td>NaN</td>
      <td>192.062425</td>
      <td>209.050852</td>
      <td>174.560338</td>
      <td>242.845655</td>
      <td>224.684363</td>
      <td>NaN</td>
      <td>1405.022760</td>
      <td>1876.941646</td>
      <td>1612.088610</td>
      <td>2993.338527</td>
      <td>2901.112367</td>
    </tr>
    <tr>
      <th>PER HOUR</th>
      <td>29.265000</td>
      <td>22.159489</td>
      <td>23.570725</td>
      <td>27.410545</td>
      <td>24.212095</td>
      <td>23.177066</td>
      <td>1348.675000</td>
      <td>588.600548</td>
      <td>512.666901</td>
      <td>475.857755</td>
      <td>624.052476</td>
      <td>679.708500</td>
    </tr>
    <tr>
      <th>PRORATED ANNUAL</th>
      <td>NaN</td>
      <td>26774.639752</td>
      <td>24266.495614</td>
      <td>26549.752066</td>
      <td>27333.981685</td>
      <td>26009.958333</td>
      <td>NaN</td>
      <td>808.867733</td>
      <td>96.959737</td>
      <td>218.843554</td>
      <td>263.200293</td>
      <td>117.033906</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">BROOKLYN</th>
      <th>PER ANNUM</th>
      <td>NaN</td>
      <td>61959.211599</td>
      <td>63611.989467</td>
      <td>66203.370088</td>
      <td>67400.887592</td>
      <td>68356.687433</td>
      <td>NaN</td>
      <td>5772.251540</td>
      <td>5494.510776</td>
      <td>6003.883035</td>
      <td>6497.080991</td>
      <td>5841.043359</td>
    </tr>
    <tr>
      <th>PER DAY</th>
      <td>NaN</td>
      <td>228.706633</td>
      <td>250.435743</td>
      <td>230.142034</td>
      <td>273.271984</td>
      <td>277.464870</td>
      <td>NaN</td>
      <td>2150.187101</td>
      <td>2829.792890</td>
      <td>2690.540262</td>
      <td>3987.387382</td>
      <td>4541.090950</td>
    </tr>
    <tr>
      <th>PER HOUR</th>
      <td>NaN</td>
      <td>19.998751</td>
      <td>21.914079</td>
      <td>23.865114</td>
      <td>22.591124</td>
      <td>23.095998</td>
      <td>NaN</td>
      <td>847.972633</td>
      <td>778.960101</td>
      <td>672.425582</td>
      <td>817.215062</td>
      <td>779.015431</td>
    </tr>
    <tr>
      <th>PRORATED ANNUAL</th>
      <td>NaN</td>
      <td>27528.794118</td>
      <td>25489.415011</td>
      <td>32011.370213</td>
      <td>28857.308000</td>
      <td>29393.553125</td>
      <td>NaN</td>
      <td>746.439614</td>
      <td>141.365894</td>
      <td>341.782043</td>
      <td>263.126220</td>
      <td>184.399125</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">MANHATTAN</th>
      <th>PER ANNUM</th>
      <td>70302.205923</td>
      <td>66926.799450</td>
      <td>69219.929993</td>
      <td>72014.764937</td>
      <td>75038.574755</td>
      <td>77066.139305</td>
      <td>554.636012</td>
      <td>1950.544238</td>
      <td>1798.279692</td>
      <td>1888.983719</td>
      <td>1903.893006</td>
      <td>1818.831188</td>
    </tr>
    <tr>
      <th>PER DAY</th>
      <td>278.545333</td>
      <td>60.920634</td>
      <td>66.200247</td>
      <td>66.778423</td>
      <td>68.588313</td>
      <td>61.599935</td>
      <td>3886.392000</td>
      <td>80.420521</td>
      <td>155.444418</td>
      <td>145.750868</td>
      <td>173.816300</td>
      <td>164.031062</td>
    </tr>
    <tr>
      <th>PER HOUR</th>
      <td>3.790839</td>
      <td>8.753896</td>
      <td>9.441464</td>
      <td>1167.428688</td>
      <td>1405.911154</td>
      <td>1295.316307</td>
      <td>90.803226</td>
      <td>258.536014</td>
      <td>102.568193</td>
      <td>193.662038</td>
      <td>98.376645</td>
      <td>97.677109</td>
    </tr>
    <tr>
      <th>PRORATED ANNUAL</th>
      <td>NaN</td>
      <td>30113.815237</td>
      <td>32451.825311</td>
      <td>33278.138812</td>
      <td>35156.646578</td>
      <td>36080.140584</td>
      <td>NaN</td>
      <td>638.141782</td>
      <td>283.669740</td>
      <td>287.708828</td>
      <td>192.155898</td>
      <td>239.800706</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">QUEENS</th>
      <th>PER ANNUM</th>
      <td>72638.769939</td>
      <td>64872.518101</td>
      <td>66468.231356</td>
      <td>67518.476146</td>
      <td>68833.177272</td>
      <td>70574.424486</td>
      <td>640.292439</td>
      <td>6113.675569</td>
      <td>5684.608201</td>
      <td>5539.324965</td>
      <td>5759.776885</td>
      <td>5555.284024</td>
    </tr>
    <tr>
      <th>PER DAY</th>
      <td>NaN</td>
      <td>254.609522</td>
      <td>274.408341</td>
      <td>261.250382</td>
      <td>271.026471</td>
      <td>284.399149</td>
      <td>NaN</td>
      <td>2612.646116</td>
      <td>3717.570491</td>
      <td>3392.948769</td>
      <td>4054.715595</td>
      <td>4678.670515</td>
    </tr>
    <tr>
      <th>PER HOUR</th>
      <td>28.836250</td>
      <td>26.367431</td>
      <td>30.445100</td>
      <td>32.692165</td>
      <td>31.694309</td>
      <td>31.842055</td>
      <td>73.767500</td>
      <td>639.035013</td>
      <td>722.053218</td>
      <td>587.611901</td>
      <td>698.913643</td>
      <td>644.501699</td>
    </tr>
    <tr>
      <th>PRORATED ANNUAL</th>
      <td>NaN</td>
      <td>29193.782209</td>
      <td>29777.313043</td>
      <td>29397.394958</td>
      <td>29777.990566</td>
      <td>31113.146893</td>
      <td>NaN</td>
      <td>976.124172</td>
      <td>262.186652</td>
      <td>395.754790</td>
      <td>328.796509</td>
      <td>302.280734</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">STATEN ISLAND</th>
      <th>PER ANNUM</th>
      <td>73064.887850</td>
      <td>65302.354034</td>
      <td>67092.591946</td>
      <td>69204.875021</td>
      <td>70285.517079</td>
      <td>70944.995782</td>
      <td>586.933925</td>
      <td>7431.757451</td>
      <td>7584.251536</td>
      <td>7647.716819</td>
      <td>8086.601002</td>
      <td>7448.884692</td>
    </tr>
    <tr>
      <th>PER DAY</th>
      <td>NaN</td>
      <td>306.503156</td>
      <td>326.049903</td>
      <td>346.949620</td>
      <td>353.915345</td>
      <td>362.141402</td>
      <td>NaN</td>
      <td>4887.980225</td>
      <td>6559.638149</td>
      <td>6528.085054</td>
      <td>8152.936790</td>
      <td>8834.284530</td>
    </tr>
    <tr>
      <th>PER HOUR</th>
      <td>31.514000</td>
      <td>18.891888</td>
      <td>21.512435</td>
      <td>22.148017</td>
      <td>23.313177</td>
      <td>23.942032</td>
      <td>1020.262000</td>
      <td>507.116870</td>
      <td>672.432472</td>
      <td>756.017677</td>
      <td>829.246372</td>
      <td>802.790677</td>
    </tr>
    <tr>
      <th>PRORATED ANNUAL</th>
      <td>NaN</td>
      <td>26722.350649</td>
      <td>23334.315789</td>
      <td>29979.666667</td>
      <td>29518.311475</td>
      <td>29970.100000</td>
      <td>NaN</td>
      <td>929.768182</td>
      <td>117.790000</td>
      <td>500.000000</td>
      <td>336.795082</td>
      <td>247.122000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="other-tips-and-useful-information">
<h2>Other Tips and Useful Information<a class="headerlink" href="#other-tips-and-useful-information" title="Link to this heading">#</a></h2>
<section id="counting-the-number-of-rows-for-each-unique-value">
<h3>Counting the Number of Rows for Each Unique Value<a class="headerlink" href="#counting-the-number-of-rows-for-each-unique-value" title="Link to this heading">#</a></h3>
<p>Say we want to know how many salaried employees work in each borough in each fiscal year. From this description, we know we need to pass <em>Work Location Borough</em> to the <em>index</em> argument and <em>Fiscal Year</em> to the <em>columns</em> argument. How do we tell Pandas to count the number of employees in each unique combination of borough and year? Simply pass the string <code class="docutils literal notranslate"><span class="pre">'count'</span></code> as the aggfunc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dfPay</span><span class="p">[</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Pay Basis&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PER ANNUM&#39;</span><span class="p">],</span>
               <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">,</span>
               <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">,</span>
               <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Base Salary&#39;</span><span class="p">,</span>
               <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Fiscal Year</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
    </tr>
    <tr>
      <th>Work Location Borough</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BRONX</th>
      <td>933.0</td>
      <td>21182.0</td>
      <td>21423.0</td>
      <td>22431.0</td>
      <td>22388.0</td>
      <td>22699.0</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>NaN</td>
      <td>42027.0</td>
      <td>43208.0</td>
      <td>41476.0</td>
      <td>40716.0</td>
      <td>41630.0</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>1452.0</td>
      <td>197712.0</td>
      <td>204959.0</td>
      <td>204614.0</td>
      <td>204775.0</td>
      <td>215398.0</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>652.0</td>
      <td>43211.0</td>
      <td>45569.0</td>
      <td>47918.0</td>
      <td>47701.0</td>
      <td>48372.0</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>107.0</td>
      <td>5654.0</td>
      <td>5786.0</td>
      <td>5889.0</td>
      <td>5861.0</td>
      <td>6013.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s take a look at the above code. The <em>index</em> and <em>columns</em> arguments should be self-explanatory. We passed the string <code class="docutils literal notranslate"><span class="pre">'count'</span></code> to the <em>aggfunc</em> argument. The only confusing thing might be the <em>values</em> argument. Why did I pass <em>Base Salary</em> to that? Because Pandas needs to count something. Anything. In this code, we told Pandas to count the number of rows in the <em>Base Salary</em> column for each unique value of ‘Work Location Borough’ and <em>Fiscal Year</em>. In theory, we could have counted any other column. To see this, consider the following code. It’s identical to the code above, except for the <em>values</em> argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dfPay</span><span class="p">[</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Pay Basis&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PER ANNUM&#39;</span><span class="p">],</span>
               <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">,</span>
               <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">,</span>
               <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Last Name&#39;</span><span class="p">,</span>
               <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Fiscal Year</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
    </tr>
    <tr>
      <th>Work Location Borough</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BRONX</th>
      <td>933.0</td>
      <td>21182.0</td>
      <td>21423.0</td>
      <td>22431.0</td>
      <td>22388.0</td>
      <td>22699.0</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>NaN</td>
      <td>42027.0</td>
      <td>43208.0</td>
      <td>41476.0</td>
      <td>40716.0</td>
      <td>41630.0</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>1452.0</td>
      <td>197712.0</td>
      <td>204959.0</td>
      <td>204614.0</td>
      <td>204775.0</td>
      <td>215398.0</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>652.0</td>
      <td>43211.0</td>
      <td>45569.0</td>
      <td>47918.0</td>
      <td>47701.0</td>
      <td>48372.0</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>107.0</td>
      <td>5654.0</td>
      <td>5786.0</td>
      <td>5889.0</td>
      <td>5861.0</td>
      <td>6013.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="the-pivot-table-function-returns-a-dataframe">
<h3>The <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> function returns a DataFrame<a class="headerlink" href="#the-pivot-table-function-returns-a-dataframe" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> function returns a DataFrame. That means you can save the pivot_table to a variable, change its contents, and use it in future computations. To see this, consider the following code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myPivotTable</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dfPay</span><span class="p">[</span><span class="n">dfPay</span><span class="p">[</span><span class="s1">&#39;Pay Basis&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PER ANNUM&#39;</span><span class="p">],</span>
                              <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Work Location Borough&#39;</span><span class="p">,</span>
                              <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">,</span>
                              <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Last Name&#39;</span><span class="p">,</span>
                              <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
<span class="n">myPivotTable</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Fiscal Year</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
    </tr>
    <tr>
      <th>Work Location Borough</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BRONX</th>
      <td>933.0</td>
      <td>21182.0</td>
      <td>21423.0</td>
      <td>22431.0</td>
      <td>22388.0</td>
      <td>22699.0</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>NaN</td>
      <td>42027.0</td>
      <td>43208.0</td>
      <td>41476.0</td>
      <td>40716.0</td>
      <td>41630.0</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>1452.0</td>
      <td>197712.0</td>
      <td>204959.0</td>
      <td>204614.0</td>
      <td>204775.0</td>
      <td>215398.0</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>652.0</td>
      <td>43211.0</td>
      <td>45569.0</td>
      <td>47918.0</td>
      <td>47701.0</td>
      <td>48372.0</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>107.0</td>
      <td>5654.0</td>
      <td>5786.0</td>
      <td>5889.0</td>
      <td>5861.0</td>
      <td>6013.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the type of the variable myPivotTable</span>
<span class="nb">type</span><span class="p">(</span><span class="n">myPivotTable</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.frame.DataFrame
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change the column names of myPivotTable</span>
<span class="n">myPivotTable</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FY2014&#39;</span><span class="p">,</span> <span class="s1">&#39;FY2015&#39;</span><span class="p">,</span> <span class="s1">&#39;FY2016&#39;</span><span class="p">,</span> <span class="s1">&#39;FY2017&#39;</span><span class="p">,</span> <span class="s1">&#39;FY2018&#39;</span><span class="p">,</span> <span class="s1">&#39;FY2019&#39;</span><span class="p">]</span>
<span class="n">myPivotTable</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FY2014</th>
      <th>FY2015</th>
      <th>FY2016</th>
      <th>FY2017</th>
      <th>FY2018</th>
      <th>FY2019</th>
    </tr>
    <tr>
      <th>Work Location Borough</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BRONX</th>
      <td>933.0</td>
      <td>21182.0</td>
      <td>21423.0</td>
      <td>22431.0</td>
      <td>22388.0</td>
      <td>22699.0</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>NaN</td>
      <td>42027.0</td>
      <td>43208.0</td>
      <td>41476.0</td>
      <td>40716.0</td>
      <td>41630.0</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>1452.0</td>
      <td>197712.0</td>
      <td>204959.0</td>
      <td>204614.0</td>
      <td>204775.0</td>
      <td>215398.0</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>652.0</td>
      <td>43211.0</td>
      <td>45569.0</td>
      <td>47918.0</td>
      <td>47701.0</td>
      <td>48372.0</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>107.0</td>
      <td>5654.0</td>
      <td>5786.0</td>
      <td>5889.0</td>
      <td>5861.0</td>
      <td>6013.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add a projection for FY2020</span>
<span class="n">myPivotTable</span><span class="p">[</span><span class="s1">&#39;FY2020 (projected)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myPivotTable</span><span class="p">[</span><span class="s1">&#39;FY2019&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.05</span>
<span class="n">myPivotTable</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FY2014</th>
      <th>FY2015</th>
      <th>FY2016</th>
      <th>FY2017</th>
      <th>FY2018</th>
      <th>FY2019</th>
      <th>FY2020 (projected)</th>
    </tr>
    <tr>
      <th>Work Location Borough</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BRONX</th>
      <td>933.0</td>
      <td>21182.0</td>
      <td>21423.0</td>
      <td>22431.0</td>
      <td>22388.0</td>
      <td>22699.0</td>
      <td>23833.95</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>NaN</td>
      <td>42027.0</td>
      <td>43208.0</td>
      <td>41476.0</td>
      <td>40716.0</td>
      <td>41630.0</td>
      <td>43711.50</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>1452.0</td>
      <td>197712.0</td>
      <td>204959.0</td>
      <td>204614.0</td>
      <td>204775.0</td>
      <td>215398.0</td>
      <td>226167.90</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>652.0</td>
      <td>43211.0</td>
      <td>45569.0</td>
      <td>47918.0</td>
      <td>47701.0</td>
      <td>48372.0</td>
      <td>50790.60</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>107.0</td>
      <td>5654.0</td>
      <td>5786.0</td>
      <td>5889.0</td>
      <td>5861.0</td>
      <td>6013.0</td>
      <td>6313.65</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Unit 4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="4-02%20Descriptive%20Statistics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Descriptive Statistics</p>
      </div>
    </a>
    <a class="right-next"
       href="4-04%20Regression.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Regression</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-pivot-tables-in-pandas">Overview of Pivot Tables in Pandas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-and-loading-the-data">Imports and Loading the Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unique-distinct-values">Unique / Distinct Values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Pivot Tables in Pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-pivot-table">A Simple Pivot Table</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-the-pivot-table-shows-and-how-it-computes-its-values">What the pivot table shows and how it computes its values</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-code-to-generate-the-pivot-table">Understanding the code to generate the pivot table</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-more-than-one-statistic">Computing More Than One Statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-by-multiple-variables-in-rows">Grouping By Multiple Variables in Rows</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-unique-values-when-grouping-by-multiple-variables">Understanding the Unique Values when Grouping By Multiple Variables</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-code-to-create-a-pivot-table-that-groups-by-multiple-variables">Understanding the Code to Create a Pivot Table that Groups By Multiple Variables</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-by-multiple-variables-in-rows-and-columns">Grouping By Multiple Variables in Rows and Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-unique-values-when-grouping-by-multiple-variables-in-rows-and-columns">Understanding the Unique Values When Grouping By Multiple Variables in Rows and Columns</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-code-to-create-a-pivot-table-that-groups-by-multiple-variables-in-rows-and-columns">Understanding the Code to Create a Pivot Table that Groups By Multiple Variables in Rows and Columns</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-statistics-for-multiple-variables">Computing Statistics for Multiple Variables</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-complicated-pivot-tables">More Complicated Pivot Tables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-tips-and-useful-information">Other Tips and Useful Information</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-the-number-of-rows-for-each-unique-value">Counting the Number of Rows for Each Unique Value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pivot-table-function-returns-a-dataframe">The <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> function returns a DataFrame</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Vic Anand and Kim Mendoza
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>