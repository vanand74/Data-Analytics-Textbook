
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Creating New Columns &#8212; Data Analytics for Accountants</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Unit 3/3-09 Creating New Columns';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sorting Data" href="3-10%20Sorting%20Data.html" />
    <link rel="prev" title="Selecting and Filtering Data" href="3-08%20Selecting%20and%20Filtering%20Data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/Book logo.png" class="logo__image only-light" alt="Data Analytics for Accountants - Home"/>
    <script>document.write(`<img src="../_static/Book logo.png" class="logo__image only-dark" alt="Data Analytics for Accountants - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction and Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 1: Introduction to Python and Programming</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-1%20Intro%20to%20Programming.html">Introduction to Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-2%20Control%20Flow.html">Control Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-3%20Variables.html">Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-4%20Data%20Types.html">Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-5%20Operators.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-6%20The%20Print%20Function.html">The Print Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-7%20Collections.html">Collections: Lists, Dictionaries, and Tuples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-8%20Functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%201/1-9%20Working%20with%20Strings.html">Working with Strings</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 2: Data Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-01%20Intro%20to%20Visualization.html">Introduction to Visualizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-02%20Intro%20to%20Python%27s%20Bokeh%20library.html">Creating Visualizations with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-03%20Intro%20to%20Tableau.html">Creating Visualizations with Tableau</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-04%20Bar%20charts.html">Bar Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-05%20Histograms.html">Histograms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-06%20Box%20plots.html">Box Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-07%20Scatter%20plots.html">Scatter Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-08%20Line%20charts.html">Line Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-09%20Pie%20charts.html">Pie Charts (yum!)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-10%20Heat%20maps.html">Heat Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%202/2-11%20Location-based%20maps.html">Location-based Maps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 3: Working with Data</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="3-01%20Overview%20of%20Working%20with%20Data.html">Overview of Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-02%20Working%20with%20files%20and%20folders%20on%20your%20computer.html">Working with Files and Folders on Your Computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-03%20CSV%20files.html">CSV Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-04%20Overview%20of%20Pandas.html">Overview of Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-05%20Viewing%20a%20DataFrame.html">Viewing a DataFrame</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-06%20Anatomy%20of%20a%20DataFrame.html">Anatomy of a DataFrame</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-07%20Loading%20Data%20Into%20Pandas.html">Loading Data Into Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-08%20Selecting%20and%20Filtering%20Data.html">Selecting and Filtering Data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Creating New Columns</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-10%20Sorting%20Data.html">Sorting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-11%20Modifying%20Data.html">Modifying Data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 4: Analyzing Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Unit%204/4-01%20Overview%20of%20Data%20Anaysis.html">Overview of Analyzing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%204/4-02%20Descriptive%20Statistics.html">Descriptive Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%204/4-03%20Pivot%20Tables%20in%20Pandas.html">Pivot Tables in Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Unit%204/4-04%20Regression.html">Regression</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/vanand74/Data-Analytics-Textbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/vanand74/Data-Analytics-Textbook/issues/new?title=Issue%20on%20page%20%2FUnit 3/3-09 Creating New Columns.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Unit 3/3-09 Creating New Columns.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Creating New Columns</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-and-loading-the-data">Imports and Loading the Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-little-data-exploration-i-couldn-t-resist">A Little Data Exploration (I couldn’t resist)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-column-from-a-scalar">Creating a Column from a Scalar</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-column-from-a-list">Creating a Column from a List</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-column-as-a-transformation-of-an-existing-column">Creating a Column as a Transformation of an Existing Column</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-strip-whitespace-from-string-columns-do-it-in-place">Example: Strip whitespace from string columns; do it “in place”</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-convert-a-string-column-to-uppercase-do-it-in-place">Example: Convert a string column to uppercase; do it “in place”</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#link-to-documentation-for-pandas-built-in-string-methods">Link to Documentation for Pandas Built-In String Methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-convert-numeric-columns-from-millions-to-actual-create-new-columns">Example: Convert numeric columns from millions to actual; create new columns</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-column-as-a-combination-of-multiple-columns">Creating a Column as a Combination of Multiple Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-numeric-columns-using-math">Combining Numeric Columns Using Math</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-string-columns">Combining String Columns</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conditionals-creating-a-column-using-an-if-statement">Conditionals: Creating a Column Using an if-statement</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="creating-new-columns">
<h1>Creating New Columns<a class="headerlink" href="#creating-new-columns" title="Link to this heading">#</a></h1>
<section id="learning-objectives">
<h2>Learning Objectives<a class="headerlink" href="#learning-objectives" title="Link to this heading">#</a></h2>
<div style="border: 1px solid black; padding: 10px; background-color: #EDEDED;">
    <ul>
        <li>Create a new column in a Pandas DataFrame that contains the same value in every row.</li>
        <li>Create a new column in a Pandas DataFrame from a list of values.</li>
        <li>Recognize that, when creating a column from a list, the list length must exactly equal the number of rows in the DataFrame.</li>
        <li>Create a new column in a Pandas DataFrame that is a transformation of an existing column.</li>
            <ul>
                <li>Do this "in place", where you replace an existing column with new values.</li>
                <li>Create a new column while preserving the original column.</li>
                <li>Use Pandas built-in string methods.</li>
                <li>Use arithmetic.</li>
            </ul>
        <li>Create a column as a combination of multiple existing columns. The existing columns can be numeric or string.</li>
        <li>Use numpy.where to create a new column using if-then-else logic.</li>
    </ul>
</div></section>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>In this chapter, you will learn how to create new columns in a Pandas DataFrame. After you load, clean, and explore your data, creating new columns is typically the next step as it is a prerequisite for analysis. We will show you how to create a column from a single value (i.e. you want every value in the column to be the same thing). We will show you how to create a column from a list. We will then show you how to combine existing columns to create a new column. Sometimes, the combinations are mathematical. For example, you can compute return on assets as net income divided by total assets; you would want to do this for each row of the data. Sometimes, the combinations involve strings.</p>
<p>The key idea in this chapter is that Pandas works with Series. Each column of a DataFrame is a series, so when you create a new column, you are creating a Series. Pandas makes it very easy to work with Series objects. That, in turn, makes it easy to create new columns.</p>
</section>
<section id="imports-and-loading-the-data">
<h2>Imports and Loading the Data<a class="headerlink" href="#imports-and-loading-the-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>In this chapter, we will work with accounting (balance sheet and income statement) and finance (stock price) data for Microsoft Corporation (NASDAQ: MSFT). The cell below loads the dataset that we have already cleaned for you. In the dataset there is one row per fiscal year. The data go back to 1986, the first year for which data is available for Microsoft. Following is a description of the columns in the data set.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Column</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Fiscal Year</p></td>
<td><p>The fiscal year for the row of data.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Assets - Total</p></td>
<td><p>Total assets as reported on Microsoft’s balance sheet at the close of the fiscal year. In millions.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Common Equity</p></td>
<td><p>Common stockholders’ equity as reported on Microsoft’s balance sheet at the close of the fiscal year. In millions.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Income Before Extraordinary Items</p></td>
<td><p>Income before extraordinary items as reported on Microsoft’s income statement at the close of the fiscal year. In millions.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Net Income</p></td>
<td><p>Net Income as reported on Microsoft’s income statement at the close of the fiscal year. In millions.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Adjusted Price Close - Fiscal</p></td>
<td><p>The stock price as reported on Yahoo! Finance. The price is adjusted for stock splits.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Address</p></td>
<td><p>Microsoft’s street address</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>ZIP Code</p></td>
<td><p>Microsoft’s ZIP (postal) code</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>City</p></td>
<td><p>The city in which Microsoft’s headquarters is located.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>State</p></td>
<td><p>The state in which Microsoft’s headquarters is located.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/MSFT.csv&#39;</span><span class="p">)</span>
<span class="n">dfMSFT</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fiscal Year</th>
      <th>Assets - Total</th>
      <th>Common Equity</th>
      <th>Net Income</th>
      <th>Adjusted Price Close - Fiscal</th>
      <th>Address</th>
      <th>ZIP Code</th>
      <th>City</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1986</td>
      <td>170.739</td>
      <td>139.332</td>
      <td>39.254</td>
      <td>0.068926</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1987</td>
      <td>287.754</td>
      <td>239.105</td>
      <td>71.878</td>
      <td>0.228631</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1988</td>
      <td>493.019</td>
      <td>375.498</td>
      <td>123.908</td>
      <td>0.300359</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1989</td>
      <td>720.598</td>
      <td>561.780</td>
      <td>170.538</td>
      <td>0.237597</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1990</td>
      <td>1105.349</td>
      <td>918.563</td>
      <td>279.186</td>
      <td>0.681410</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(34, 9)
</pre></div>
</div>
</div>
</div>
<section id="a-little-data-exploration-i-couldn-t-resist">
<h3>A Little Data Exploration (I couldn’t resist)<a class="headerlink" href="#a-little-data-exploration-i-couldn-t-resist" title="Link to this heading">#</a></h3>
<p>Run the cells below. They will generate graphs of Microsoft’s net income and stock price over time. As you can see, Microsoft has done really well, especially in the last few years!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">show</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">ColumnDataSource</span>
<span class="kn">from</span> <span class="nn">bokeh.layouts</span> <span class="kn">import</span> <span class="n">row</span>
<span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="kn">import</span> <span class="n">output_notebook</span>
<span class="n">output_notebook</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">    <style>
        .bk-notebook-logo {
            display: block;
            width: 20px;
            height: 20px;
            background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAOkSURBVDiNjZRtaJVlGMd/1/08zzln5zjP1LWcU9N0NkN8m2CYjpgQYQXqSs0I84OLIC0hkEKoPtiH3gmKoiJDU7QpLgoLjLIQCpEsNJ1vqUOdO7ppbuec5+V+rj4ctwzd8IIbbi6u+8f1539dt3A78eXC7QizUF7gyV1fD1Yqg4JWz84yffhm0qkFqBogB9rM8tZdtwVsPUhWhGcFJngGeWrPzHm5oaMmkfEg1usvLFyc8jLRqDOMru7AyC8saQr7GG7f5fvDeH7Ej8CM66nIF+8yngt6HWaKh7k49Soy9nXurCi1o3qUbS3zWfrYeQDTB/Qj6kX6Ybhw4B+bOYoLKCC9H3Nu/leUTZ1JdRWkkn2ldcCamzrcf47KKXdAJllSlxAOkRgyHsGC/zRday5Qld9DyoM4/q/rUoy/CXh3jzOu3bHUVZeU+DEn8FInkPBFlu3+nW3Nw0mk6vCDiWg8CeJaxEwuHS3+z5RgY+YBR6V1Z1nxSOfoaPa4LASWxxdNp+VWTk7+4vzaou8v8PN+xo+KY2xsw6une2frhw05CTYOmQvsEhjhWjn0bmXPjpE1+kplmmkP3suftwTubK9Vq22qKmrBhpY4jvd5afdRA3wGjFAgcnTK2s4hY0/GPNIb0nErGMCRxWOOX64Z8RAC4oCXdklmEvcL8o0BfkNK4lUg9HTl+oPlQxdNo3Mg4Nv175e/1LDGzZen30MEjRUtmXSfiTVu1kK8W4txyV6BMKlbgk3lMwYCiusNy9fVfvvwMxv8Ynl6vxoByANLTWplvuj/nF9m2+PDtt1eiHPBr1oIfhCChQMBw6Aw0UulqTKZdfVvfG7VcfIqLG9bcldL/+pdWTLxLUy8Qq38heUIjh4XlzZxzQm19lLFlr8vdQ97rjZVOLf8nclzckbcD4wxXMidpX30sFd37Fv/GtwwhzhxGVAprjbg0gCAEeIgwCZyTV2Z1REEW8O4py0wsjeloKoMr6iCY6dP92H6Vw/oTyICIthibxjm/DfN9lVz8IqtqKYLUXfoKVMVQVVJOElGjrnnUt9T9wbgp8AyYKaGlqingHZU/uG2NTZSVqwHQTWkx9hxjkpWDaCg6Ckj5qebgBVbT3V3NNXMSiWSDdGV3hrtzla7J+duwPOToIg42ChPQOQjspnSlp1V+Gjdged7+8UN5CRAV7a5EdFNwCjEaBR27b3W890TE7g24NAP/mMDXRWrGoFPQI9ls/MWO2dWFAar/xcOIImbbpA3zgAAAABJRU5ErkJggg==);
        }
    </style>
    <div>
        <a href="https://bokeh.org" target="_blank" class="bk-notebook-logo"></a>
        <span id="be4d738b-69b2-4e50-aa33-d9a0ed5bb4c7">Loading BokehJS ...</span>
    </div>
</div><script type="application/javascript">'use strict';
(function(root) {
  function now() {
    return new Date();
  }

  const force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

const JS_MIME_TYPE = 'application/javascript';
  const HTML_MIME_TYPE = 'text/html';
  const EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  const CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    const script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    function drop(id) {
      const view = Bokeh.index.get_by_id(id)
      if (view != null) {
        view.model.document.clear()
        Bokeh.index.delete(view)
      }
    }

    const cell = handle.cell;

    const id = cell.output_area._bokeh_element_id;
    const server_id = cell.output_area._bokeh_server_id;

    // Clean up Bokeh references
    if (id != null) {
      drop(id)
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      const cmd_clean = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd_clean, {
        iopub: {
          output: function(msg) {
            const id = msg.content.text.trim()
            drop(id)
          }
        }
      });
      // Destroy server and session
      const cmd_destroy = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd_destroy);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    const output_area = handle.output_area;
    const output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!Object.prototype.hasOwnProperty.call(output.data, EXEC_MIME_TYPE))) {
      return
    }

    const toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      const bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      const script_attrs = bk_div.children[0].attributes;
      for (let i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      const toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      const props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    const events = require('base/js/events');
    const OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  const NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded(error = null) {
    const el = document.getElementById("be4d738b-69b2-4e50-aa33-d9a0ed5bb4c7");
    if (el != null) {
      const html = (() => {
        if (typeof root.Bokeh === "undefined") {
          if (error == null) {
            return "BokehJS is loading ...";
          } else {
            return "BokehJS failed to load.";
          }
        } else {
          const prefix = `BokehJS ${root.Bokeh.version}`;
          if (error == null) {
            return `${prefix} successfully loaded.`;
          } else {
            return `${prefix} <b>encountered errors</b> while loading and may not function as expected.`;
          }
        }
      })();
      el.innerHTML = html;

      if (error != null) {
        const wrapper = document.createElement("div");
        wrapper.style.overflow = "auto";
        wrapper.style.height = "5em";
        wrapper.style.resize = "vertical";
        const content = document.createElement("div");
        content.style.fontFamily = "monospace";
        content.style.whiteSpace = "pre-wrap";
        content.style.backgroundColor = "rgb(255, 221, 221)";
        content.textContent = error.stack ?? error.toString();
        wrapper.append(content);
        el.append(wrapper);
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(() => display_loaded(error), 100);
    }
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error(url) {
      console.error("failed to load " + url);
    }

    for (let i = 0; i < css_urls.length; i++) {
      const url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    for (let i = 0; i < js_urls.length; i++) {
      const url = js_urls[i];
      const element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  const js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-3.4.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.4.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.4.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.4.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-3.4.2.min.js"];
  const css_urls = [];

  const inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {
    }
  ];

  function run_inline_js() {
    if (root.Bokeh !== undefined || force === true) {
      try {
            for (let i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }

      } catch (error) {display_loaded(error);throw error;
      }if (force === true) {
        display_loaded();
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      const cell = $(document.getElementById("be4d738b-69b2-4e50-aa33-d9a0ed5bb4c7")).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }
  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">dfMSFT</span><span class="p">)</span>

<span class="n">p1</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> 
            <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">,</span> <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;$ millions&#39;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Net Income&#39;</span><span class="p">)</span>
<span class="n">p1</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Net Income&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>

<span class="n">p2</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
            <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">,</span> <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Stock Price, adjusted for splits&#39;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Stock Price (Adj.)&#39;</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Adjusted Price Close - Fiscal&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>

<span class="n">show</span><span class="p">(</span><span class="n">row</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="a149dd1e-dae2-40ef-be61-42c24718ea3c" data-root-id="p1088" style="display: contents;"></div>
</div><script type="application/javascript">(function(root) {
  function embed_document(root) {
  const docs_json = {"e5fc34d0-8a07-4214-b055-d6eba507fd0a":{"version":"3.4.2","title":"Bokeh Application","roots":[{"type":"object","name":"Row","id":"p1088","attributes":{"children":[{"type":"object","name":"Figure","id":"p1004","attributes":{"width":400,"height":400,"x_range":{"type":"object","name":"DataRange1d","id":"p1005"},"y_range":{"type":"object","name":"DataRange1d","id":"p1006"},"x_scale":{"type":"object","name":"LinearScale","id":"p1014"},"y_scale":{"type":"object","name":"LinearScale","id":"p1015"},"title":{"type":"object","name":"Title","id":"p1007","attributes":{"text":"Net Income"}},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p1043","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1001","attributes":{"selected":{"type":"object","name":"Selection","id":"p1002","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1003"},"data":{"type":"map","entries":[["index",{"type":"ndarray","array":{"type":"bytes","data":"AAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAAAARAAAAEgAAABMAAAAUAAAAFQAAABYAAAAXAAAAGAAAABkAAAAaAAAAGwAAABwAAAAdAAAAHgAAAB8AAAAgAAAAIQAAAA=="},"shape":[34],"dtype":"int32","order":"little"}],["Fiscal Year",{"type":"ndarray","array":{"type":"bytes","data":"wgcAAMMHAADEBwAAxQcAAMYHAADHBwAAyAcAAMkHAADKBwAAywcAAMwHAADNBwAAzgcAAM8HAADQBwAA0QcAANIHAADTBwAA1AcAANUHAADWBwAA1wcAANgHAADZBwAA2gcAANsHAADcBwAA3QcAAN4HAADfBwAA4AcAAOEHAADiBwAA4wcAAA=="},"shape":[34],"dtype":"int32","order":"little"}],["Assets - Total",{"type":"ndarray","array":{"type":"bytes","data":"z/dT46VXZUDy0k1iEPxxQPyp8dJN0H5AEFg5tMiEhkA3iUFgZUWRQNv5fmq8sJlAkxgEVs6fpEAAAAAAALqtQAAAAAAA87RAAAAAAAAqvEAAAAAAgLbDQAAAAACAGcxAAAAAAEDV1UAAAAAAgCTiQAAAAADAdulAAAAAACDv7EAAAAAA4IPwQAAAAAAwbfNAAAAAAFCO9kAAAAAA8EnxQAAAAADQ/fBAAAAAAGDY7kAAAAAAkMXxQAAAAAAABPNAAAAAABAG9UAAAAAAAIr6QAAAAABwm/1AAAAAAPhiAUEAAAAAAAsFQQAAAAD4ggVBAAAAAPCkB0EAAAAA8G0NQQAAAAAAmQ9BAAAAAHB9EUE="},"shape":[34],"dtype":"float64","order":"little"}],["Common Equity",{"type":"ndarray","array":{"type":"bytes","data":"tMh2vp9qYUCPwvUoXONtQIcW2c73d3dACtejcD2OgUAv3SQGgbSMQOf7qfFSG5VAI9v5fuohoUAAAAAAAFSpQAAAAAAAYrFAAAAAAADVtEAAAAAAAPy6QAAAAACAIsNAAAAAAICPzkAAAAAAgNDaQAAAAAAAM+RAAAAAACAX50AAAAAAgHrpQAAAAACAy+1AAAAAAJBE8kAAAAAAYH7nQAAAAAAAleNAAAAAAEBe3kAAAAAAwLfhQAAAAADAUONAAAAAAOCL5kAAAAAAYN/rQAAAAACwM/BAAAAAAABG80AAAAAAgOv1QAAAAAAwjfNAAAAAANCT8UAAAAAAoKzxQAAAAADgMfRAAAAAAKD7+EA="},"shape":[34],"dtype":"float64","order":"little"}],["Net Income",{"type":"ndarray","array":{"type":"bytes","data":"jZduEoOgQ0DVeOkmMfhRQCcxCKwc+l5A8KfGSzdRZUDl0CLb+XJxQNnO91Pj63xAFK5H4XoghkAAAAAAAMiNQAAAAAAA6JFAAAAAAAC0lkAAAAAAACahQAAAAAAA/KpAAAAAAACKsUAAAAAAAGm+QAAAAACAZsJAAAAAAACyvEAAAAAAAJW+QAAAAACAhMNAAAAAAADov0AAAAAAAO/HQAAAAACAm8hAAAAAAIB4y0AAAAAAQETRQAAAAACAdMxAAAAAAABS0kAAAAAAgJvWQAAAAACAlNBAAAAAAMBZ1UAAAAAAgI7VQAAAAACA0MdAAAAAAIBn0EAAAAAAALXUQAAAAADALtBAAAAAAAAp40A="},"shape":[34],"dtype":"float64","order":"little"}],["Adjusted Price Close - Fiscal",{"type":"ndarray","array":{"type":"bytes","data":"rRbYYyKlsT//Bu3Vx0PNP/vKg/QUOdM/3lhQGJRpzj8DWyVYHM7lP2nEzD6PUe0/TaPJxRiY9j+jA5Kwb2f8P/p9/+bFqQBAvt2SHLArDUClSSno9mITQK0zvi8uZSRAjX3JxoN9MUC3Xz5ZMRw9QElNu5hm0jlAH4E//PyPN0B9yjFZ3KcxQPyKNVzkmjBAVyWRfZCZMkAnwoanVzIyQDFcHQBxSzFA6dK/JJUtNkBrY+yElwA1QDHsMCb9lTJAYcQ+ARRXMkAyVpv/Vzk1QCAnTBjNpjlAxm00gLfYPUBE+BdBY4xCQGDNAYI5KERA3lomw/ECSEBaoN0hxZNQQDZWYp6VLVhA9Z81P36wYEA="},"shape":[34],"dtype":"float64","order":"little"}],["Address",{"type":"ndarray","array":["One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way","One Microsoft Way"],"shape":[34],"dtype":"object","order":"little"}],["ZIP Code",{"type":"ndarray","array":{"type":"bytes","data":"BH8BAAR/AQAEfwEABH8BAAR/AQAEfwEABH8BAAR/AQAEfwEABH8BAAR/AQAEfwEABH8BAAR/AQAEfwEABH8BAAR/AQAEfwEABH8BAAR/AQAEfwEABH8BAAR/AQAEfwEABH8BAAR/AQAEfwEABH8BAAR/AQAEfwEABH8BAAR/AQAEfwEABH8BAA=="},"shape":[34],"dtype":"int32","order":"little"}],["City",{"type":"ndarray","array":["  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond ","  Redmond "],"shape":[34],"dtype":"object","order":"little"}],["State",{"type":"ndarray","array":["wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa"],"shape":[34],"dtype":"object","order":"little"}]]}}},"view":{"type":"object","name":"CDSView","id":"p1044","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1045"}}},"glyph":{"type":"object","name":"Line","id":"p1040","attributes":{"x":{"type":"field","field":"Fiscal Year"},"y":{"type":"field","field":"Net Income"},"line_color":"#1f77b4"}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1041","attributes":{"x":{"type":"field","field":"Fiscal Year"},"y":{"type":"field","field":"Net Income"},"line_color":"#1f77b4","line_alpha":0.1}},"muted_glyph":{"type":"object","name":"Line","id":"p1042","attributes":{"x":{"type":"field","field":"Fiscal Year"},"y":{"type":"field","field":"Net Income"},"line_color":"#1f77b4","line_alpha":0.2}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p1013","attributes":{"tools":[{"type":"object","name":"PanTool","id":"p1026"},{"type":"object","name":"WheelZoomTool","id":"p1027","attributes":{"renderers":"auto"}},{"type":"object","name":"BoxZoomTool","id":"p1028","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p1029","attributes":{"syncable":false,"level":"overlay","visible":false,"left":{"type":"number","value":"nan"},"right":{"type":"number","value":"nan"},"top":{"type":"number","value":"nan"},"bottom":{"type":"number","value":"nan"},"left_units":"canvas","right_units":"canvas","top_units":"canvas","bottom_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"SaveTool","id":"p1034"},{"type":"object","name":"ResetTool","id":"p1035"},{"type":"object","name":"HelpTool","id":"p1036"}]}},"left":[{"type":"object","name":"LinearAxis","id":"p1021","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1022","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1023"},"axis_label":"$ millions","major_label_policy":{"type":"object","name":"AllLabels","id":"p1024"}}}],"below":[{"type":"object","name":"LinearAxis","id":"p1016","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1017","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1018"},"axis_label":"Fiscal Year","major_label_policy":{"type":"object","name":"AllLabels","id":"p1019"}}}],"center":[{"type":"object","name":"Grid","id":"p1020","attributes":{"axis":{"id":"p1016"}}},{"type":"object","name":"Grid","id":"p1025","attributes":{"dimension":1,"axis":{"id":"p1021"}}}]}},{"type":"object","name":"Figure","id":"p1046","attributes":{"width":400,"height":400,"x_range":{"type":"object","name":"DataRange1d","id":"p1047"},"y_range":{"type":"object","name":"DataRange1d","id":"p1048"},"x_scale":{"type":"object","name":"LinearScale","id":"p1056"},"y_scale":{"type":"object","name":"LinearScale","id":"p1057"},"title":{"type":"object","name":"Title","id":"p1049","attributes":{"text":"Stock Price (Adj.)"}},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p1085","attributes":{"data_source":{"id":"p1001"},"view":{"type":"object","name":"CDSView","id":"p1086","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1087"}}},"glyph":{"type":"object","name":"Line","id":"p1082","attributes":{"x":{"type":"field","field":"Fiscal Year"},"y":{"type":"field","field":"Adjusted Price Close - Fiscal"},"line_color":"#1f77b4"}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1083","attributes":{"x":{"type":"field","field":"Fiscal Year"},"y":{"type":"field","field":"Adjusted Price Close - Fiscal"},"line_color":"#1f77b4","line_alpha":0.1}},"muted_glyph":{"type":"object","name":"Line","id":"p1084","attributes":{"x":{"type":"field","field":"Fiscal Year"},"y":{"type":"field","field":"Adjusted Price Close - Fiscal"},"line_color":"#1f77b4","line_alpha":0.2}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p1055","attributes":{"tools":[{"type":"object","name":"PanTool","id":"p1068"},{"type":"object","name":"WheelZoomTool","id":"p1069","attributes":{"renderers":"auto"}},{"type":"object","name":"BoxZoomTool","id":"p1070","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p1071","attributes":{"syncable":false,"level":"overlay","visible":false,"left":{"type":"number","value":"nan"},"right":{"type":"number","value":"nan"},"top":{"type":"number","value":"nan"},"bottom":{"type":"number","value":"nan"},"left_units":"canvas","right_units":"canvas","top_units":"canvas","bottom_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"SaveTool","id":"p1076"},{"type":"object","name":"ResetTool","id":"p1077"},{"type":"object","name":"HelpTool","id":"p1078"}]}},"left":[{"type":"object","name":"LinearAxis","id":"p1063","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1064","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1065"},"axis_label":"Stock Price, adjusted for splits","major_label_policy":{"type":"object","name":"AllLabels","id":"p1066"}}}],"below":[{"type":"object","name":"LinearAxis","id":"p1058","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1059","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1060"},"axis_label":"Fiscal Year","major_label_policy":{"type":"object","name":"AllLabels","id":"p1061"}}}],"center":[{"type":"object","name":"Grid","id":"p1062","attributes":{"axis":{"id":"p1058"}}},{"type":"object","name":"Grid","id":"p1067","attributes":{"dimension":1,"axis":{"id":"p1063"}}}]}}]}}]}};
  const render_items = [{"docid":"e5fc34d0-8a07-4214-b055-d6eba507fd0a","roots":{"p1088":"a149dd1e-dae2-40ef-be61-42c24718ea3c"},"root_ids":["p1088"]}];
  void root.Bokeh.embed.embed_items_notebook(docs_json, render_items);
  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    let attempts = 0;
    const timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);</script></div>
</div>
</section>
</section>
<section id="creating-a-column-from-a-scalar">
<h2>Creating a Column from a Scalar<a class="headerlink" href="#creating-a-column-from-a-scalar" title="Link to this heading">#</a></h2>
<p>Look at the cell below, which shows the first few rows of the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fiscal Year</th>
      <th>Assets - Total</th>
      <th>Common Equity</th>
      <th>Net Income</th>
      <th>Adjusted Price Close - Fiscal</th>
      <th>Address</th>
      <th>ZIP Code</th>
      <th>City</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1986</td>
      <td>170.739</td>
      <td>139.332</td>
      <td>39.254</td>
      <td>0.068926</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1987</td>
      <td>287.754</td>
      <td>239.105</td>
      <td>71.878</td>
      <td>0.228631</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1988</td>
      <td>493.019</td>
      <td>375.498</td>
      <td>123.908</td>
      <td>0.300359</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1989</td>
      <td>720.598</td>
      <td>561.780</td>
      <td>170.538</td>
      <td>0.237597</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1990</td>
      <td>1105.349</td>
      <td>918.563</td>
      <td>279.186</td>
      <td>0.681410</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice that the data is missing Microsoft’s stock ticker symbol, MSFT. Let’s add that as a new column. Run the cell below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;Ticker&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;MSFT&#39;</span>
<span class="n">dfMSFT</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fiscal Year</th>
      <th>Assets - Total</th>
      <th>Common Equity</th>
      <th>Net Income</th>
      <th>Adjusted Price Close - Fiscal</th>
      <th>Address</th>
      <th>ZIP Code</th>
      <th>City</th>
      <th>State</th>
      <th>Ticker</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1986</td>
      <td>170.739</td>
      <td>139.332</td>
      <td>39.254</td>
      <td>0.068926</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1987</td>
      <td>287.754</td>
      <td>239.105</td>
      <td>71.878</td>
      <td>0.228631</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1988</td>
      <td>493.019</td>
      <td>375.498</td>
      <td>123.908</td>
      <td>0.300359</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1989</td>
      <td>720.598</td>
      <td>561.780</td>
      <td>170.538</td>
      <td>0.237597</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1990</td>
      <td>1105.349</td>
      <td>918.563</td>
      <td>279.186</td>
      <td>0.681410</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Look at the rightmost column, <em>Ticker</em>. Notice that it has the string ‘MSFT’ in every row. It’s that simple! That’s all that’s needed to create a new column with a single value.</p>
<p>Even though the above line of code, <code class="docutils literal notranslate"><span class="pre">dfMSFT['Ticker']</span> <span class="pre">=</span> <span class="pre">'MSFT'</span></code> appears really simple, there’s a lot going on behind the scenes. You need to understand a little of that before we proceed. When you wrote <code class="docutils literal notranslate"><span class="pre">dfMSFT['Ticker']</span></code>, that refers to a Series. Remember that single brackets means Series. So Pandas looked into the DataFrame <code class="docutils literal notranslate"><span class="pre">dfMSFT</span></code> and discovered that there is no existing column with the name <em>Ticker</em>. Pandas then inferred that you want to create that column. Now the DataFrame <code class="docutils literal notranslate"><span class="pre">dfMSFT</span></code> has 34 rows, but you gave Pandas only one value. Pandas therefore inferred that you want that same value in every row. It therefore created a Series for you, and repeated the string value ‘MSFT’ 34 times (the language R calls this “recycling”).</p>
<p>So to summarize, to create a new column from a single value:</p>
<ul class="simple">
<li><p>Type the DataFrame name followed by single brackets</p></li>
<li><p>Inside the single brackets, type the name of the new column as a string</p></li>
<li><p>After the brackets, type an equals sign, and then the value you want.</p></li>
<li><p>This value will be repeated in every row. It can be numeric or string.</p></li>
</ul>
</section>
<section id="creating-a-column-from-a-list">
<h2>Creating a Column from a List<a class="headerlink" href="#creating-a-column-from-a-list" title="Link to this heading">#</a></h2>
<p>It is possible to create a new column from a list. That is because Pandas can easily convert a list to a Series. The only catch is that the list must have the same length as the DataFrame! If the DataFrame has <em>n</em> rows, the list length must be exactly <em>n</em>.</p>
<p>When might you want to do this? Here’s a silly example. Many years ago, I read that Bill Gates used to eat M&amp;M’s and drink Diet Coke. I think I heard that when Bill Gates was a guest on the Tonight Show with Jay Leno. But eventually he got married and his wife likely put a stop to that. Let’s say that for the first 10 years, Bill liked Diet Coke and M&amp;M’s, but afterwards, he liked rice cakes. Let’s create a new column in the dataset called <em>Bill Gates likes</em>. We’ll populate that column using a list.</p>
<p>Take a look at the code cells below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a list of length 10</span>
<span class="n">bill_likes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Diet Coke and M&amp;Ms&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>
<span class="c1"># Add 24 values to the list</span>
<span class="n">bill_likes</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Rice cakes&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">24</span>

<span class="nb">print</span><span class="p">(</span><span class="n">bill_likes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The list length is: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">bill_likes</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Diet Coke and M&amp;Ms&#39;, &#39;Diet Coke and M&amp;Ms&#39;, &#39;Diet Coke and M&amp;Ms&#39;, &#39;Diet Coke and M&amp;Ms&#39;, &#39;Diet Coke and M&amp;Ms&#39;, &#39;Diet Coke and M&amp;Ms&#39;, &#39;Diet Coke and M&amp;Ms&#39;, &#39;Diet Coke and M&amp;Ms&#39;, &#39;Diet Coke and M&amp;Ms&#39;, &#39;Diet Coke and M&amp;Ms&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;, &#39;Rice cakes&#39;]

The list length is: 34
</pre></div>
</div>
</div>
</div>
<p>Now let’s create a new column in our dataset and populate it with our list. Look at the code cell below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;Bill Gates likes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bill_likes</span>
<span class="n">dfMSFT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fiscal Year</th>
      <th>Assets - Total</th>
      <th>Common Equity</th>
      <th>Net Income</th>
      <th>Adjusted Price Close - Fiscal</th>
      <th>Address</th>
      <th>ZIP Code</th>
      <th>City</th>
      <th>State</th>
      <th>Ticker</th>
      <th>Bill Gates likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1986</td>
      <td>170.739</td>
      <td>139.332</td>
      <td>39.254</td>
      <td>0.068926</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Diet Coke and M&amp;Ms</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1987</td>
      <td>287.754</td>
      <td>239.105</td>
      <td>71.878</td>
      <td>0.228631</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Diet Coke and M&amp;Ms</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1988</td>
      <td>493.019</td>
      <td>375.498</td>
      <td>123.908</td>
      <td>0.300359</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Diet Coke and M&amp;Ms</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1989</td>
      <td>720.598</td>
      <td>561.780</td>
      <td>170.538</td>
      <td>0.237597</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Diet Coke and M&amp;Ms</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1990</td>
      <td>1105.349</td>
      <td>918.563</td>
      <td>279.186</td>
      <td>0.681410</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Diet Coke and M&amp;Ms</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1991</td>
      <td>1644.184</td>
      <td>1350.831</td>
      <td>462.743</td>
      <td>0.916206</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Diet Coke and M&amp;Ms</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1992</td>
      <td>2639.903</td>
      <td>2192.958</td>
      <td>708.060</td>
      <td>1.412133</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Diet Coke and M&amp;Ms</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1993</td>
      <td>3805.000</td>
      <td>3242.000</td>
      <td>953.000</td>
      <td>1.775253</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Diet Coke and M&amp;Ms</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1994</td>
      <td>5363.000</td>
      <td>4450.000</td>
      <td>1146.000</td>
      <td>2.082897</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Diet Coke and M&amp;Ms</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1995</td>
      <td>7210.000</td>
      <td>5333.000</td>
      <td>1453.000</td>
      <td>3.646332</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Diet Coke and M&amp;Ms</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1996</td>
      <td>10093.000</td>
      <td>6908.000</td>
      <td>2195.000</td>
      <td>4.846645</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1997</td>
      <td>14387.000</td>
      <td>9797.000</td>
      <td>3454.000</td>
      <td>10.197618</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1998</td>
      <td>22357.000</td>
      <td>15647.000</td>
      <td>4490.000</td>
      <td>17.490292</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1999</td>
      <td>37156.000</td>
      <td>27458.000</td>
      <td>7785.000</td>
      <td>29.110128</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2000</td>
      <td>52150.000</td>
      <td>41368.000</td>
      <td>9421.000</td>
      <td>25.821878</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2001</td>
      <td>59257.000</td>
      <td>47289.000</td>
      <td>7346.000</td>
      <td>23.562454</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2002</td>
      <td>67646.000</td>
      <td>52180.000</td>
      <td>7829.000</td>
      <td>17.655706</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2003</td>
      <td>79571.000</td>
      <td>61020.000</td>
      <td>9993.000</td>
      <td>16.605047</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2004</td>
      <td>92389.000</td>
      <td>74825.000</td>
      <td>8168.000</td>
      <td>18.599861</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2005</td>
      <td>70815.000</td>
      <td>48115.000</td>
      <td>12254.000</td>
      <td>18.196650</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2006</td>
      <td>69597.000</td>
      <td>40104.000</td>
      <td>12599.000</td>
      <td>17.294693</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2007</td>
      <td>63171.000</td>
      <td>31097.000</td>
      <td>14065.000</td>
      <td>22.178057</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2008</td>
      <td>72793.000</td>
      <td>36286.000</td>
      <td>17681.000</td>
      <td>21.002312</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2009</td>
      <td>77888.000</td>
      <td>39558.000</td>
      <td>14569.000</td>
      <td>18.585894</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2010</td>
      <td>86113.000</td>
      <td>46175.000</td>
      <td>18760.000</td>
      <td>18.340149</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2011</td>
      <td>108704.000</td>
      <td>57083.000</td>
      <td>23150.000</td>
      <td>21.223999</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2012</td>
      <td>121271.000</td>
      <td>66363.000</td>
      <td>16978.000</td>
      <td>25.651567</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2013</td>
      <td>142431.000</td>
      <td>78944.000</td>
      <td>21863.000</td>
      <td>29.846550</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2014</td>
      <td>172384.000</td>
      <td>89784.000</td>
      <td>22074.000</td>
      <td>37.096779</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2015</td>
      <td>176223.000</td>
      <td>80083.000</td>
      <td>12193.000</td>
      <td>40.314255</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2016</td>
      <td>193694.000</td>
      <td>71997.000</td>
      <td>16798.000</td>
      <td>48.023003</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2017</td>
      <td>241086.000</td>
      <td>72394.000</td>
      <td>21204.000</td>
      <td>66.308907</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2018</td>
      <td>258848.000</td>
      <td>82718.000</td>
      <td>16571.000</td>
      <td>96.712257</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2019</td>
      <td>286556.000</td>
      <td>102330.000</td>
      <td>39240.000</td>
      <td>133.515411</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>wa</td>
      <td>MSFT</td>
      <td>Rice cakes</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If you look at the entire DataFrame, you will notice that the last column contains our list. Under the hood, Pandas took our list, created a new Series (using the constructor <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code>), and added that Series as a new column of the DataFrame.</p>
<p>As we mentioned before, the list length must be exactly equal to the number of rows of the DataFrame. If it differs, you will get an error. To see this, look at the code below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;Bill Gates likes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Diet Coke and M&amp;Ms&#39;</span><span class="p">,</span> <span class="s1">&#39;Rice cakes&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;Bill Gates likes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Diet Coke and M&amp;Ms&#39;</span><span class="p">,</span> <span class="s1">&#39;Rice cakes&#39;</span><span class="p">]</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\core\frame.py:4311,</span> in <span class="ni">DataFrame.__setitem__</span><span class="nt">(self, key, value)</span>
<span class="g g-Whitespace">   </span><span class="mi">4308</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_setitem_array</span><span class="p">([</span><span class="n">key</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4309</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4310</span>     <span class="c1"># set column</span>
<span class="ne">-&gt; </span><span class="mi">4311</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_set_item</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\core\frame.py:4524,</span> in <span class="ni">DataFrame._set_item</span><span class="nt">(self, key, value)</span>
<span class="g g-Whitespace">   </span><span class="mi">4514</span> <span class="k">def</span> <span class="nf">_set_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4515</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">4516</span><span class="sd">     Add series to DataFrame in specified column.</span>
<span class="g g-Whitespace">   </span><span class="mi">4517</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">4522</span><span class="sd">     ensure homogeneity.</span>
<span class="g g-Whitespace">   </span><span class="mi">4523</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">4524</span>     <span class="n">value</span><span class="p">,</span> <span class="n">refs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sanitize_column</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4526</span>     <span class="k">if</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">4527</span>         <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
<span class="g g-Whitespace">   </span><span class="mi">4528</span>         <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span>
<span class="g g-Whitespace">   </span><span class="mi">4529</span>         <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">ExtensionDtype</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4530</span>     <span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">4531</span>         <span class="c1"># broadcast across multiple columns if necessary</span>
<span class="g g-Whitespace">   </span><span class="mi">4532</span>         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">is_unique</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">MultiIndex</span><span class="p">):</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\core\frame.py:5266,</span> in <span class="ni">DataFrame._sanitize_column</span><span class="nt">(self, value)</span>
<span class="g g-Whitespace">   </span><span class="mi">5263</span>     <span class="k">return</span> <span class="n">_reindex_for_setitem</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5265</span> <span class="k">if</span> <span class="n">is_list_like</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">5266</span>     <span class="n">com</span><span class="o">.</span><span class="n">require_length_match</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5267</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">sanitize_array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_2d</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5268</span> <span class="k">if</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">5269</span>     <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Index</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5270</span>     <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;object&quot;</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5273</span>     <span class="c1"># TODO: Remove kludge in sanitize_array for string mode when enforcing</span>
<span class="g g-Whitespace">   </span><span class="mi">5274</span>     <span class="c1"># this deprecation</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\core\common.py:573,</span> in <span class="ni">require_length_match</span><span class="nt">(data, index)</span>
<span class="g g-Whitespace">    </span><span class="mi">569</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">570</span><span class="sd"> Check the length of data matches the length of the index.</span>
<span class="g g-Whitespace">    </span><span class="mi">571</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">572</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">573</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">574</span>         <span class="s2">&quot;Length of values &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">575</span>         <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">) &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">576</span>         <span class="s2">&quot;does not match length of index &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">577</span>         <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">578</span>     <span class="p">)</span>

<span class="ne">ValueError</span>: Length of values (2) does not match length of index (34)
</pre></div>
</div>
</div>
</div>
<p>Look at the last line of the error message. It tells you that the list length does not equal the number of rows.</p>
</section>
<section id="creating-a-column-as-a-transformation-of-an-existing-column">
<h2>Creating a Column as a Transformation of an Existing Column<a class="headerlink" href="#creating-a-column-as-a-transformation-of-an-existing-column" title="Link to this heading">#</a></h2>
<p>It is very common to transform a column. By transform, we mean do something to it, like strip out white space, or perform a mathematical transformation. In this section, we will provide some examples that show you how to do it. We will:</p>
<ul class="simple">
<li><p>Strip whitespace from all string columns.</p></li>
<li><p>Convert state abbreviations to uppercase.</p></li>
<li><p>Convert all balance sheet and income statement columns from millions of dollars to actual dollars.</p></li>
</ul>
<p>Often, when cleaning data like this, you want to clean the data “in place”. That means that you don’t want to create new columns. You want to transform the data and store it in the existing columns. We’ll show you how to do that with the string columns. For the numeric columns, we’ll create new columns.</p>
<section id="example-strip-whitespace-from-string-columns-do-it-in-place">
<h3>Example: Strip whitespace from string columns; do it “in place”<a class="headerlink" href="#example-strip-whitespace-from-string-columns-do-it-in-place" title="Link to this heading">#</a></h3>
<p>Let’s take a look at the values in the <em>City</em> column. If you look closely, you’ll find that there are unneeded whitespace characters. We put those there to dirty the data. See the next cell:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;  Redmond &#39;
</pre></div>
</div>
</div>
</div>
<p>The following code cell strips whitespace from the <em>City</em> column and saves the result in the same column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s analyze the previous code, specifically the right-hand side of the equals sign. There, we wrote <code class="docutils literal notranslate"><span class="pre">dfMSFT['City'].str.strip()</span></code>. That tells Pandas to take the column <em>City</em> as a Series and run the string method <code class="docutils literal notranslate"><span class="pre">strip</span></code>. With no arguments, that method removes leading and trailing whitespace characters from every value in the Series and returns a new Series. We then save that new Series in the existing column <code class="docutils literal notranslate"><span class="pre">dfMSFT['City']</span></code>. Let’s check whether it worked by running the code below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Redmond&#39;
</pre></div>
</div>
</div>
</div>
<p>Now let’s repeat this for all string columns. The easiest way to do that is with a for loop. Notice that we are using the for loop to iterate over columns. That’s fine. Do not iterate over rows with a for loop unless absolutely necessary! Iterating over rows is very slow. It’s literally thousands of times faster to use Pandas methods to iterate over rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Address&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;Ticker&#39;</span><span class="p">,</span> <span class="s1">&#39;Bill Gates likes&#39;</span><span class="p">]:</span>
    <span class="n">dfMSFT</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Notice how compact the code is! For each column, it strips the whitespace and saves the new, cleaned column in its original location.</p>
</section>
<section id="example-convert-a-string-column-to-uppercase-do-it-in-place">
<h3>Example: Convert a string column to uppercase; do it “in place”<a class="headerlink" href="#example-convert-a-string-column-to-uppercase-do-it-in-place" title="Link to this heading">#</a></h3>
<p>Notice that the <em>State</em> column contains the string ‘wa’. In the U.S., we typically write state abbreviations using uppercase. Let’s convert that column. The code is very similar to what we did in the previous section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="n">dfMSFT</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fiscal Year</th>
      <th>Assets - Total</th>
      <th>Common Equity</th>
      <th>Net Income</th>
      <th>Adjusted Price Close - Fiscal</th>
      <th>Address</th>
      <th>ZIP Code</th>
      <th>City</th>
      <th>State</th>
      <th>Ticker</th>
      <th>Bill Gates likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1986</td>
      <td>170.739</td>
      <td>139.332</td>
      <td>39.254</td>
      <td>0.068926</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>WA</td>
      <td>MSFT</td>
      <td>Diet Coke and M&amp;Ms</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1987</td>
      <td>287.754</td>
      <td>239.105</td>
      <td>71.878</td>
      <td>0.228631</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>WA</td>
      <td>MSFT</td>
      <td>Diet Coke and M&amp;Ms</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1988</td>
      <td>493.019</td>
      <td>375.498</td>
      <td>123.908</td>
      <td>0.300359</td>
      <td>One Microsoft Way</td>
      <td>98052</td>
      <td>Redmond</td>
      <td>WA</td>
      <td>MSFT</td>
      <td>Diet Coke and M&amp;Ms</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice that we called the built-in string method <code class="docutils literal notranslate"><span class="pre">upper</span></code> on the column and saved the result in the column <em>State</em>. The code took the column <em>State</em>, which is a Series, and ran a string method on it. That method returned a new Series, which we saved as the column <em>State</em>. Thus, the new Series overwrote the existing Series.</p>
</section>
<section id="link-to-documentation-for-pandas-built-in-string-methods">
<h3>Link to Documentation for Pandas Built-In String Methods<a class="headerlink" href="#link-to-documentation-for-pandas-built-in-string-methods" title="Link to this heading">#</a></h3>
<p>Pandas provides many useful methods for working with columns of strings. Here’s <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/text.html#method-summary">a link to the documentation</a>. Check it out! We usually learn something new every time we visit this page.</p>
</section>
<section id="example-convert-numeric-columns-from-millions-to-actual-create-new-columns">
<h3>Example: Convert numeric columns from millions to actual; create new columns<a class="headerlink" href="#example-convert-numeric-columns-from-millions-to-actual-create-new-columns" title="Link to this heading">#</a></h3>
<p>Sometimes, you wish to transform your data but preserve the existing data. Let’s say we want to convert the balance sheet and income statement amounts from millions of dollars to actual dollars. We can do this by multiplying each value by one million. Here’s some code to do it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Assets - Total&#39;</span><span class="p">,</span> <span class="s1">&#39;Common Equity&#39;</span><span class="p">,</span> <span class="s1">&#39;Net Income&#39;</span><span class="p">]:</span>
    <span class="n">dfMSFT</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> ACTUAL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000000</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s walk through that code for the first column, ‘Assets - Total’. When the for loop executed for this value, the variable <code class="docutils literal notranslate"><span class="pre">col</span></code> was set to <code class="docutils literal notranslate"><span class="pre">'Assets</span> <span class="pre">-</span> <span class="pre">Total'</span></code>. The code that was executed was:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> ACTUAL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000000</span>
</pre></div>
</div>
<p>The right-hand side took the Series <code class="docutils literal notranslate"><span class="pre">dfMSFT['Assets</span> <span class="pre">-</span> <span class="pre">Total']</span></code> and multiplied each value by one million. It saved the result in a new Series. Notice that we didn’t have to write a for loop. Pandas automatically did the multiplication for every value in the series. We then stored the result in a new column ‘Assets - Total ACTUAL’. Notice we used an f-string to create the new column name.</p>
<p>Let’s take a look at the first few rows of the data, for only the Assets columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="p">[[</span><span class="s1">&#39;Assets - Total&#39;</span><span class="p">,</span> <span class="s1">&#39;Assets - Total ACTUAL&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Assets - Total</th>
      <th>Assets - Total ACTUAL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>170.739</td>
      <td>1.707390e+08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>287.754</td>
      <td>2.877540e+08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>493.019</td>
      <td>4.930190e+08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>720.598</td>
      <td>7.205980e+08</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1105.349</td>
      <td>1.105349e+09</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice that, in each row, the amount in the ‘Assets - Total ACTUAL’ column is exactly one million times the value in the ‘Assets - Total’ column.</p>
</section>
</section>
<section id="creating-a-column-as-a-combination-of-multiple-columns">
<h2>Creating a Column as a Combination of Multiple Columns<a class="headerlink" href="#creating-a-column-as-a-combination-of-multiple-columns" title="Link to this heading">#</a></h2>
<p>Often, you want to create a column that is a combination of multiple columns. Sometimes, you want to combine the columns using math. In other situations, you want to combine strings. In this section, we’ll show you examples of both.</p>
<section id="combining-numeric-columns-using-math">
<h3>Combining Numeric Columns Using Math<a class="headerlink" href="#combining-numeric-columns-using-math" title="Link to this heading">#</a></h3>
<p>Let’s compute return on assets (ROA) in each year. ROA is defined as net income divided by average total assets during the year. For simplicity, let’s just use total assets at the end of the year. Thus, ROA in year t will be computed as net income for year t divided by assets at the end of year t.</p>
<p>The code is really simple:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;ROA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;Net Income&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;Assets - Total&#39;</span><span class="p">]</span>
<span class="n">dfMSFT</span><span class="p">[[</span><span class="s1">&#39;Net Income&#39;</span><span class="p">,</span> <span class="s1">&#39;Assets - Total&#39;</span><span class="p">,</span> <span class="s1">&#39;ROA&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Net Income</th>
      <th>Assets - Total</th>
      <th>ROA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39.254</td>
      <td>170.739</td>
      <td>0.229906</td>
    </tr>
    <tr>
      <th>1</th>
      <td>71.878</td>
      <td>287.754</td>
      <td>0.249790</td>
    </tr>
    <tr>
      <th>2</th>
      <td>123.908</td>
      <td>493.019</td>
      <td>0.251325</td>
    </tr>
    <tr>
      <th>3</th>
      <td>170.538</td>
      <td>720.598</td>
      <td>0.236662</td>
    </tr>
    <tr>
      <th>4</th>
      <td>279.186</td>
      <td>1105.349</td>
      <td>0.252577</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>First, notice that we do not need to adjust for millions. Both net income and total assets are denominated in millions, so we can simply divide the two.</p>
<p>Second, look at the line of code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;ROA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;Net Income&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;Assets - Total&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>We divided a Series by a Series. When we do that, Pandas assumes you want to perform division row-by-row. And since both Series are columns in the same DataFrame, we don’t have to worry about length. Since they are columns of the same DataFrame, they have the exact same length.</p>
</section>
<section id="combining-string-columns">
<h3>Combining String Columns<a class="headerlink" href="#combining-string-columns" title="Link to this heading">#</a></h3>
<p>Our data has separate columns for the street address, city, state, and ZIP code. Let’s combine them into a complete postal address. Take a look at the code below. The string <code class="docutils literal notranslate"><span class="pre">'\n'</span></code> means “newline character”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;Full Address&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;Address&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;ZIP Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The above code adds multiple Series together. As with numeric columns, Pandas assumes you want to combine values in each row. Also notice that we can add a single string value to a Series and Pandas figures out you want to add that value to every row.</p>
<p>Finally, notice that we had to convert the <em>ZIP Code</em> column to string before we could add it to the other string columns.</p>
<p>Let’s take a look at one of the final address values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dfMSFT</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Full Address&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>One Microsoft Way
Redmond, WA 98052
</pre></div>
</div>
</div>
</div>
<p>You might think this is a trivial example because the address is the same in every year. However, companies sometimes move their headquarters. For example, a few years ago, Boeing Corp. moved their headquarters from Seattle to Chicago.</p>
</section>
</section>
<section id="conditionals-creating-a-column-using-an-if-statement">
<h2>Conditionals: Creating a Column Using an if-statement<a class="headerlink" href="#conditionals-creating-a-column-using-an-if-statement" title="Link to this heading">#</a></h2>
<p>Say you want to create a column whose values are based on a condition. Let’s say that in years where Microsoft’s ROA exceeds 20%, you were impressed. In other years, you were underwhelmed. You want a new column called <em>Impression</em> that contains the string “Wow!” or “Meh”, based on the ROA in that year.</p>
<p>There are many ways to do this. We recommend you use the NumPy function <code class="docutils literal notranslate"><span class="pre">numpy.where</span></code>. Here’s a link to <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.where.html">the official documentation for that function</a>.</p>
<p>Take a look at the code cell below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;Performance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dfMSFT</span><span class="p">[</span><span class="s1">&#39;ROA&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s2">&quot;Wow!&quot;</span><span class="p">,</span> <span class="s2">&quot;Meh&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.where.html">documentation for numpy.where</a> tells us that the first argument is a condition that can be “array like”. That means we can pass it a Series of True/False values, which we did. We passed it a Series that contains True for values that exceed 20%, and False otherwise. The next argument is “x”, which is the value returned for True values. The final argument is “y”, the value returned for False values.</p>
<p>Numpy.where created an “array”, which is like a list. Since Pandas is built on top of NumPy, Pandas converted that array to a Series and then created a new column called ‘Performance’.</p>
<p>Let’s take a look at 5 randomly chosen rows below. Notice that those rows that contain ROA greater (fiscal years 1990 and 2008) than 20% have “Wow!” in the new column. Rows that don’t meet that condition have “Meh” in the new column (fiscal years 2017, 2004, and 2003).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfMSFT</span><span class="p">[[</span><span class="s1">&#39;Fiscal Year&#39;</span><span class="p">,</span> <span class="s1">&#39;ROA&#39;</span><span class="p">,</span> <span class="s1">&#39;Performance&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fiscal Year</th>
      <th>ROA</th>
      <th>Performance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>1990</td>
      <td>0.252577</td>
      <td>Wow!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2017</td>
      <td>0.087952</td>
      <td>Meh</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2004</td>
      <td>0.088409</td>
      <td>Meh</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2008</td>
      <td>0.242894</td>
      <td>Wow!</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2003</td>
      <td>0.125586</td>
      <td>Meh</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Unit 3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3-08%20Selecting%20and%20Filtering%20Data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Selecting and Filtering Data</p>
      </div>
    </a>
    <a class="right-next"
       href="3-10%20Sorting%20Data.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Sorting Data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-and-loading-the-data">Imports and Loading the Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-little-data-exploration-i-couldn-t-resist">A Little Data Exploration (I couldn’t resist)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-column-from-a-scalar">Creating a Column from a Scalar</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-column-from-a-list">Creating a Column from a List</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-column-as-a-transformation-of-an-existing-column">Creating a Column as a Transformation of an Existing Column</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-strip-whitespace-from-string-columns-do-it-in-place">Example: Strip whitespace from string columns; do it “in place”</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-convert-a-string-column-to-uppercase-do-it-in-place">Example: Convert a string column to uppercase; do it “in place”</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#link-to-documentation-for-pandas-built-in-string-methods">Link to Documentation for Pandas Built-In String Methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-convert-numeric-columns-from-millions-to-actual-create-new-columns">Example: Convert numeric columns from millions to actual; create new columns</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-column-as-a-combination-of-multiple-columns">Creating a Column as a Combination of Multiple Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-numeric-columns-using-math">Combining Numeric Columns Using Math</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-string-columns">Combining String Columns</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conditionals-creating-a-column-using-an-if-statement">Conditionals: Creating a Column Using an if-statement</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Vic Anand and Kim Mendoza
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>